!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.DCAgent={})}(this,function(e){"use strict";function t(){if(Te)return Te;if(Me+=1,!(Me>4)){var e={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"};for(var t in e){var n=e[t];if(n.indexOf(".")>-1){var r=n.split("."),o=Pe[r[0]];if(o&&o[r[1]])return Te=t,t}else if(Pe[n])return Te=t,t}}}function n(){}function r(e){return"function"==typeof e}function o(e){return e&&"[object Object]"===Ve.call(e)}function i(e){console.log("---- DCAgent log start ----\n"+e+"\n---- DCAgent log end   ----")}function c(e){var t,n,r;return t=Date.now(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r=n.replace(/[xy]/g,function(e){var n;return n=(t+16*Math.random())%16|0,t=Math.floor(t/16),"x"===e?n.toString(16):(7&n|8).toString(16)}),(e||"")+r.replace(/-/g,"").toUpperCase()}function a(e){var t,n;for(t in e)n=e[t],e[t]=n;var r=arguments.length>=2?[].slice.call(arguments,1):[];return r.forEach(function(r){var o;o=[];for(t in r)n=r[t],o.push(e[t]=n);return o}),e}function u(e){var t=".";try{return e.setItem(t,t),e.removeItem(t),!0}catch(n){return!1}}function s(e){for(var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n="",r=0;t>r;r+=1)n+=e;return n}function f(e,t,n){return e?e&&e.length>=n?e:e+s(t,Math.ceil(n-e.length)/t.length):e}function g(e,t,n){return function(){Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);var r,o;for(r=0;r<t.length;r+=1)if(o=t[r],ke(o,this,arguments)===!1)return;var i=ke(e,this,arguments);if(i===!1)return!1;for(r=0;r<n.length;r+=1)o=n[r],ke(o,this,arguments);return i}}function l(e){if(!e)return"";var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return t?t[3]:""}function p(e,t,n){return[].slice.call(e,t,n)}function d(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return e>=1e21&&(e=9527e16),Pe.parseInt(e,n)||t}function h(e){try{return e?JSON.stringify(e):null}catch(t){i("invalid json format")}return null}function m(e){try{return e?JSON.parse(e):null}catch(t){i("invalid json string")}return null}function b(){var e=we.loginTime||we.initTime;return{loginTime:e,onlineTime:Oe.parseInt(Date.now()/1e3)-e||1,extendMap:{from:we.from,engine:t()||"",app:we.app}}}function j(e,t){var n={headerInfo:tt,onlineInfo:b(),errorInfoList:De.concat(),eventInfoList:nt.concat()};return e&&(n.paymentInfo=e),t&&(n.userInfo=t),n}function v(){nt.length=0,De.length=0}function E(){Bt.setItem(_e.LOGOUT_TIME,Oe.parseInt(Date.now()/1e3)),(De.length||nt.length)&&Bt.setItem(_e.QUIT_SNAPSHOT,Oe.jsonStringify(j()))}function T(){return Oe.jsonParse(Bt.getItem(_e.QUIT_SNAPSHOT))}function I(e){rt>=ye.MAX_ERROR_COUNT||(De.push(e),rt+=1)}function O(e){nt.push(e)}function y(e,t){if(!e)return Oe.tryThrow("Missing eventId"),!1;arguments.length>2&&(t=arguments[2]);var n={};if(Oe.isObject(t))for(var r in t)n[r.replace("%","_")]="number"==typeof t[r]?t[r]:encodeURIComponent(t[r]);return Ie.addEvent({eventId:e,eventMap:n}),!0}function _(){return tt.uid||""}function S(e,t){var n=this;this.duration=t,this.status="running",this.timer=Xt(function(){return n.run()},this.duration),this.run=function(){qt(n.timer),Oe.attempt(e),n.timer=Xt(function(){return n.run()},n.duration)},this.stop=function(){n.status="stopped",qt(n.timer)},this.reset=function(e){n.stop(),e&&(n.duration=e),n.run()}}function A(e){Kt&&(Kt.stop(),Xt(function(){Kt.reset(e)},e))}function C(e,t){Kt=new S(e,t)}function L(){return Kt}function N(e){var t=Pe.egret,n=new t.URLLoader,r=Date.now();n.addEventListener(t.Event.COMPLETE,function(t){var n=Date.now()-r,o=t.target,i="success"===o.data;Oe.attempt(i?e.success:e.error,o,[o,n,n>=e.timeout]),Oe.attempt(e.complete,o,[o,n])});var o=new t.URLRequest(e.url);o.method=e.method||t.URLRequestMethod.POST,o.data=Oe.jsonStringify(e.data),n.load(o)}function x(){return new Pe.XMLHttpRequest}function R(){return Pe.cc.loader.getXMLHttpRequest()}function D(e){var t=Wt();t.timeout=e.timeout,t.open(e.method||"POST",e.url,!0),t.setRequestHeader("Content-Type","text/plain; charset=UTF-8");var n=Date.now();t.onreadystatechange=function(){if(4===this.readyState){var t=this.status>=200&&this.status<300,r=Date.now()-n;Oe.attempt(t?e.success:e.error,this,[this,r]),Oe.attempt(e.complete,this,[this,r]),this.onreadystatechange=null,this.ontimeout=null}},t.ontimeout=function(){var t=Date.now()-n;Oe.attempt(e.error,this,[this,t,!0]),Oe.attempt(e.complete,this,[this,t]),this.onreadystatechange=null,this.ontimeout=null},t.send(Oe.jsonStringify(e.data))}function w(e,t){var n=Date.now();if(!t){if(Zt&&n-Zt<ye.ASAP_TIMEOUT)return void Oe.tryThrow("Request dropped: unexpected behavior");Zt=n}$t+=1,Jt({url:e.url,data:e.data,success:function(t,n){Oe.attempt(e.success,t,[t,n])},error:function(t,n,r){Qt+=1,Oe.attempt(e.error,t,[t,n,r])},complete:function(t,n){if(Oe.attempt(e.complete,t,[t,n]),t.getAllResponseHeaders&&t.getResponseHeader){var r=t.getAllResponseHeaders(),o="X-Rate-Limit";if(-1!==r.indexOf(o)){var i=Oe.parseInt(t.getResponseHeader(o));i>1&&Se.reset(1e3*i)}}}})}function U(e){if(!e)return!1;var t=e.onlineInfo.onlineTime;return 1>t||t>ye.MAX_ONLINE_TIME?(Oe.tryThrow("Illegal online time"),!1):!0}function P(){return we.inited?void 0:(Oe.tryThrow("DCAgent.init needed"),!1)}function M(){return we.loginTime?void 0:(Oe.tryThrow("DCAgent.login needed"),!1)}function V(){if(He&&r(He.createElement)){var e=He.createElement("div");if(!e)return!1;if(r(e.querySelector)){e.innerHTML="<i></i>";var t=e.querySelector("i");return!!t&&"I"===t.tagName}if(r(e.getElementsByTagName)){var n=e.getElementsByTagName("i");return!!n&&1===n.length}}return!1}function F(e){return e+"?__deuid="+tt.uid+"&__deappid="+tt.appId}function G(e){return e+"?type=h520&appId="+tt.appId+"&uid="+tt.uid+"&mac="+(tt.mac||"")+"&imei="+(tt.imei||"")+"&idfa="+(tt.idfa||"")}function k(e,t,n){if(e||!Oe.hiddenProperty||!He[Oe.hiddenProperty]){var r={url:Le.appendOnline(on)};if($t&&$t%we.oss===0&&Ie.addEvent({eventId:_e.REQ_KEY,eventMap:{succ:$t-Qt,fail:Qt,total:$t}}),r.data=Ie.collect(t,n),Ae.isParamsValid(r.data)){Ie.clear();var o=r.data.errorInfoList,i=r.data.eventInfoList;(i.length||o.length)&&(r.error=function(){o.forEach(function(e){Ie.addError(e)}),i.forEach(function(e){Ie.addEvent(e)})}),w(r,e)}}}function H(e){if(!e)return void Oe.tryThrow("Missing accountID");if(tt.accountId===e)return void(we.loginTime=we.loginTime||Oe.parseInt(Date.now()/1e3));we.loginTime=Oe.parseInt(Date.now()/1e3);var t=Se.get();t.stop(),k(!0);var n=_e.ACCOUNT_RELATED_SETTINGS+","+_e.ACCOUNT_ROLE_SETTINGS;n.split(",").forEach(function(e){return tt[e]=""}),tt.age=ye.DEFAULT_AGE,tt.gender=ye.DEFAULT_GENDER,tt.roleLevel=ye.DEFAULT_ROLE_LEVEL,tt.accountId=e,k(!0),Xt(function(){t.run()},t.duration)}function B(){console.log("debounce"),qt(Yt);var e=Se.get();e.stop(),Yt=Xt(function(){e.run()},ye.ASAP_TIMEOUT)}function X(e,t,n,r){var o=arguments;_e.ACCOUNT_ROLE_SETTINGS.split(",").forEach(function(e,t){return tt[e]=o[t]||""}),tt.roleLevel=Oe.parseInt(r)||1}function q(e,t,n,r){X(e,t,n,r),y("DE_EVENT_CREATE_ROLE",{roleId:String(e),roleRace:String(t),roleClass:String(n)})}function K(e){tt.gender=2===e?2:1}function Y(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];tt.gameServer=String(e)}function z(e){e=Oe.parseInt(e),tt.age=e>0&&128>e?e:0}function Q(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];tt.accountType=String(e)}function W(e,t){y(_e.EVT_TASK,{actionType:"taskUnfinish",taskId:e,elapsed:Oe.parseInt(t)})}function J(e,t){y(_e.EVT_TASK,{actionType:"taskFinish",taskId:e,elapsed:Oe.parseInt(t)})}function $(e){e&&e.hasOwnProperty("amount")&&k(!0,{currencyAmount:parseFloat(e.amount,10)||0,currencyType:e.currencyType||"CNY",payType:String(e.payType||""),iapid:String(e.iapid||""),payTime:Oe.parseInt(Date.now()/1e3),extendMap:{orderId:String(e.orderId||"")}})}function Z(e,t){y(_e.EVT_MISSION,{actionType:"guankaUnfinish",guankaId:e,duration:Oe.parseInt(t)})}function ee(e,t){y(_e.EVT_MISSION,{actionType:"guankaFinish",guankaId:e,duration:Oe.parseInt(t)})}function te(e,t,n){t=Oe.parseInt(t),tt.roleLevel=t,y(_e.EVT_LEVEL,{startLevel:Oe.parseInt(e),endLevel:t,duration:Oe.parseInt(n)})}function ne(e,t,n,r){y(_e.EVT_ITEM,{actionType:"itemUse",itemId:e,itemNum:Oe.parseInt(t),reason:r,missonID:n})}function re(e,t,n,r){y(_e.EVT_ITEM,{actionType:"itemGet",itemId:e,itemNum:Oe.parseInt(t),missonID:n,reason:r})}function oe(e,t,n,r,o){y(_e.EVT_ITEM,{actionType:"itemBuy",itemId:e,itemNum:Oe.parseInt(t),coinType:n,coinNum:Oe.parseInt(r),missonID:o})}function ie(e,t,n,r){y(_e.EVT_COIN,{actionType:"coinUse",coinType:n,balanceNum:Oe.parseInt(t),coinNum:Oe.parseInt(e),reason:r})}function ce(e,t,n,r){y(_e.EVT_COIN,{actionType:"coinGet",coinType:n,balanceNum:Oe.parseInt(t),coinNum:Oe.parseInt(e),reason:r})}function ae(){return we.inited}function ue(){for(var e=["pagehide","beforeunload","unload"],t=0;t<e.length;t+=1)if("on"+e[t]in Pe)return e[t]}function se(e){if(Pe.addEventListener){var t=ue();t&&Pe.addEventListener(t,e)}}function fe(){Pe.addEventListener&&Pe.addEventListener("error",function(e){Oe.attempt(function(){var t={},n=["colno","filename","lineno","message"];n.forEach(function(n){return t[n]=e[n]||"1"});var r=e.error||{};if(t.stack=encodeURIComponent(r.stack||r.stacktrace||""),t.type=r.name||"Error",t.timestamp=parseInt(e.timeStamp/1e3),Oe.isFunction(we.getErrorScene)){var o=Oe.attempt(we.getErrorScene,r,[e]);if(o){if(Oe.isObject(o)){var i="";for(var c in o)i+="	"+c+"="+o[c]+"\n";o=i}else o=String(o);t.stack+="\n\nError scene:\n"+encodeURIComponent(o)}}Ie.addError(t)})},!1)}function ge(e){return Ce.isStandardBrowser||_e.CLIENT_KEY===e?e:tt.appId+"."+e}function le(e,t){e=ge(e),Bt.setItem(e,t),bn.set(e,t,3650)}function pe(e){return e=ge(e),Bt.getItem(e)||bn.get(e)}function de(){var e=Date.now().toString(36).toUpperCase(),t=Re.engine;return t.egret?_e.EGRET_PREFIX+e:t.layabox?_e.LAYA_PREFIX+e:t.cocos?_e.COCOS_PREFIX+e:_e.UNKNOW_ENGINE+e}function he(e){var t,n;t=Array.prototype.forEach,n=Array.prototype.map,this.each=function(e,n,r){if(null!==e)if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===+e.length){for(var o=0,i=e.length;i>o;o++)if(n.call(r,e[o],o,e)==={})return}else for(var c in e)if(e.hasOwnProperty(c)&&n.call(r,e[c],c,e)==={})return},this.map=function(e,t,r){var o=[];return null==e?o:n&&e.map===n?e.map(t,r):(this.each(e,function(e,n,i){o[o.length]=t.call(r,e,n,i)}),o)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)}function me(){var e;try{if(Ce.isStandardBrowser)e=new En({canvas:!0,screen_resolution:!0,ie_activex:!0}).get().toString();else if(Re.engine.layabox){var t=Pe.layabox.getDeviceInfo()||{};e=t.mac||t.idfa,e=e&&e.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(n){e=null}return e=Oe.padding(e,_e.PADDING_STRING,ye.UID_MIN_LENGTH),e||Oe.uuid(de())}function be(e){if(tt.uid){var t=Oe.padding(tt.uid,_e.PADDING_STRING,ye.UID_MIN_LENGTH);e!==t&&(tt.uid=t,e=t,Bt.setItem(_e.CREATE_TIME,Oe.parseInt(Date.now()/1e3)))}var n=e||me();return xe.setItem(_e.CLIENT_KEY,n),n}function je(e){var t=xe.getItem(_e.CLIENT_KEY),n=t?0:1,r=be(t);tt.uid=r,tt.accountId=r,e.errorReport&&fe(),we.initTime=Oe.parseInt(Date.now()/1e3);var o=Bt.getItem(_e.CREATE_TIME);o||(o=we.initTime,Bt.setItem(_e.CREATE_TIME,o)),we.createTime=Oe.parseInt(o);var i=Ce.isStandardBrowser?nn.href:"!";Ie.addEvent({eventId:_e.EVT_PV,eventMap:{page:encodeURI(i.split("?")[0])}});var c=n?{actTime:o,regTime:o}:null;k(!0,null,c),se(Ie.saveToStorage);var a=1e3*Math.max(ye.MIN_ONLINE_INTERVAL,parseFloat(e.interval||ye.MIN_ONLINE_INTERVAL));Se.set(k,a),we.inited=!0}function ve(e){return Oe.isLocalStorageSupported(Bt)?we.inited?"Initialization ignored":e&&e.appId?(e.appId=e.appId.toUpperCase(),we.oss="number"==typeof e.oss?e.oss:0,we.getErrorScene=e.getErrorScene,we.app=e.appName||"",we.from=e.from||Oe.getHostName(He.referrer),void _e.USER_INIT_BASE_SETTINGS.split(",").forEach(function(t){e.hasOwnProperty(t)&&(tt[t]=e[t])})):"Missing appId":Ce.hasStorage?"Storage quota error":"Storage not support"}function Ee(e){var t=ve(e);return t?Oe.tryThrow(t):(je(e),void w({url:Le.appendEcho(Ce.protocol+"//"+_e.HOST+"/echo"),method:"GET"},!0))}var Te,Ie={get getOnlineInfo(){return b},get collect(){return j},get clear(){return v},get saveToStorage(){return E},get loadFromStorage(){return T},get addError(){return I},get addEvent(){return O}},Oe={get noop(){return n},get isFunction(){return r},get isObject(){return o},get log(){return i},get tryThrow(){return Ge},get uuid(){return c},get extend(){return a},get attempt(){return ke},get isLocalStorageSupported(){return u},get repeat(){return s},get padding(){return f},get aspect(){return g},get getHostName(){return l},get hiddenProperty(){return Be},get slice(){return p},get parseInt(){return d},get jsonStringify(){return h},get jsonParse(){return m}},ye={get REQUEST_TIME_OUT(){return Xe},get MAX_ONLINE_TIME(){return qe},get MIN_ONLINE_INTERVAL(){return Ke},get UID_MIN_LENGTH(){return Ye},get ASAP_TIMEOUT(){return ze},get MAX_ERROR_COUNT(){return Qe},get DEFAULT_AGE(){return We},get DEFAULT_GENDER(){return Je},get DEFAULT_ROLE_LEVEL(){return $e},get DEFAULT_NET_TYPE(){return Ze},get DEFAULT_PLATFORM(){return et}},_e={get HOST(){return jt},get CREATE_TIME(){return vt},get EGRET_PREFIX(){return Et},get LAYA_PREFIX(){return Tt},get COCOS_PREFIX(){return It},get UNKNOW_ENGINE(){return Ot},get PARENT_KEY(){return yt},get EVENTS_KEY(){return _t},get ERRORS_KEY(){return St},get CLIENT_KEY(){return At},get QUIT_SNAPSHOT(){return Ct},get LOGOUT_TIME(){return Lt},get API_PATH(){return Nt},get PADDING_STRING(){return xt},get REQ_KEY(){return Rt},get USER_INIT_BASE_SETTINGS(){return Dt},get ACCOUNT_RELATED_SETTINGS(){return wt},get ACCOUNT_ROLE_SETTINGS(){return Ut},get EVT_COIN(){return Pt},get EVT_ITEM(){return Mt},get EVT_LEVEL(){return Vt},get EVT_MISSION(){return Ft},get EVT_TASK(){return Gt},get EVT_PV(){return kt}},Se={get reset(){return A},get set(){return C},get get(){return L}},Ae={get isParamsValid(){return U},get shouldBeInited(){return P},get shouldBeLoggedIn(){return M}},Ce={get hasStorage(){return Ht},get isStandardBrowser(){return en},get hasCookie(){return tn},get protocol(){return rn},get device(){return ht}},Le={get appendOnline(){return F},get appendEcho(){return G}},Ne={get debounce(){return B}},xe={get setItem(){return le},get getItem(){return pe}},Re={get engine(){return ut},get"default"(){return t}},De=[],we={inited:!1},Ue=(1,eval)("this"),Pe=Ue||{},Me=0,Ve=Object.prototype.toString,Fe=Pe.DCAGENT_DEBUG_OPEN,Ge=Fe?function(e){throw new Error(e)}:function(e){i(e)},ke=Fe?function(e,t,n){return r(e)?e.apply(t,n):void 0}:function(e,t,n){if(r(e))try{return e.apply(t,n)}catch(o){i("exec error for function:\n "+e.toString())}},He=Ue.document||{},Be="hidden"in He?"hidden":"webkitHidden"in He?"webkitHidden":"mozHidden"in He?"mozHidden":"msHidden"in He?"msHidden":null;e.version=24;var Xe=3e4,qe=172800,Ke=40,Ye=32,ze=5e3,Qe=100,We=0,Je=0,$e=0,Ze=3,et=0,tt={accountId:"",accountType:"",age:ye.DEFAULT_AGE,appId:"",appVersion:"",brand:"",channel:"",customDeviceId:"",gameServer:"",gender:ye.DEFAULT_GENDER,idfa:"",imei:"",lonLat:"",mac:"",netType:ye.DEFAULT_NET_TYPE,operator:"",osVersion:"",platform:ye.DEFAULT_PLATFORM,resolution:"",roleClass:"",roleId:"",roleLevel:ye.DEFAULT_ROLE_LEVEL,roleRace:"",simCardOp:"",uid:"",ver:e.version},nt=[],rt=0,ot=ye.DEFAULT_PLATFORM,it=Pe.screen||{},ct=it.width&&it.width+"*"+it.height,at="0*0";ct||(ct=at);var ut={isEgret:!!Pe.egret,isLayabox:!!Pe.layabox,isCocos:!!Pe.cc&&!!Pe.cc.game},st="",ft="",gt=Pe.navigator&&Pe.navigator.userAgent||"";if(!gt){var lt=["ios","android"];if(ut.layabox){var pt=Pe.layabox.getDeviceInfo()||{};ct=pt.resolution||at,ft=pt.phonemodel,ot=lt.indexOf(pt.os.toLowerCase()),st=(pt.os+" "+pt.osversion).toLowerCase()}else if(ut.cocos){var dt=Pe.cc.view.getViewPortRect()||{};ct=dt.width+"*"+dt.height,ot=lt.indexOf(Pe.cc.sys.os.toLowerCase())}-1===[0,1,2,3].indexOf(ot)&&(ot=ye.DEFAULT_PLATFORM)}var ht={resolution:ct,brand:ft,osVersion:st,platform:ot};for(var mt in ht)tt[mt]=tt[mt]||ht[mt];var bt,jt="rd.gdatacube.net",vt="dcagent_create_time",Et="EGRET",Tt="LAYA",It="COCOS",Ot="UE",yt="dcagent_parent_id",_t="dcagent_client_events",St="dcagent_client_errors",At="dcagent_client_id",Ct="dcagent_snapshot",Lt="dc_p_lo",Nt="/dc/hh5/sync",xt="0A",Rt="DE_EVENT_OSS",Dt="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",wt="accountId,accountType,age,gender,gameServer",Ut="roleId,roleRace,roleClass,roleLevel",Pt="DE_EVENT_COIN_ACTION",Mt="DE_EVENT_ITEM_ACTION",Vt="DE_EVENT_LEVELUP",Ft="DE_EVENT_GUANKA_ACTION",Gt="DE_EVENT_TASK_ACTION",kt="DE_EVENT_PV",Ht=!!Pe.localStorage||ut.isEgret||ut.isCocos||ut.isLayabox;bt=ut.isEgret?Pe.egret.localStorage:ut.isCocos?Pe.cc.sys.localStorage:Ht?Pe.localStorage:{getItem:n,setItem:n,removeItem:n};var Bt=bt,Xt=Pe.setTimeout,qt=Pe.clearTimeout;ut.isEgret&&(Xt=function(e,t){Pe.egret.setTimeout(e,Pe,t)},qt=function(e){Pe.egret.clearTimeout(e)});var Kt,Yt,zt,Qt=0,Wt=ut.isCocos?R:x,Jt=function(){return Pe.XMLHttpRequest||ut.isCocos?D:ut.isEgret?N:(Oe.log("XMLHttpRequest not found"),Oe.noop)}(),$t=0,Zt=0,en=V(),tn=en&&"cookie"in He,nn=Ue.location||{},rn="https:"===nn.protocol?"https:":"http:",on=Ce.protocol+"//"+_e.HOST+_e.API_PATH,cn={login:H,getUid:_,onEvent:y},an={onCoinGet:ce,onCoinUse:ie,onItemBuy:oe,onItemProduce:re,onItemUse:ne,onLevelUp:te,onMissionFinished:ee,onMissionUnfinished:Z,onPayment:$,onTaskFinished:J,onTaskUnfinished:W,setAccountType:Q,setAge:z,setGameServer:Y,setGender:K,setRoleInfo:X,createRole:q},un=[Ae.shouldBeInited],sn=[Ae.shouldBeLoggedIn],fn=[Ne.debounce];for(zt in cn)e[zt]=Oe.aspect(cn[zt],un,"onEvent"===zt&&fn);for(zt in an)e[zt]=Oe.aspect(an[zt],sn,"onPayment"!==zt&&fn);var gn=Pe.DCAgentObject;if(gn){var ln=Pe[gn];if(Oe.isFunction(ln)){var pn=ln.cache;pn.length&&(pn.forEach(function(t){Oe.attempt(e[t[0]],e,Oe.slice(t,1))}),pn.length=0)}}var dn={get isNew(){var e=we.loginTime||we.initTime;return we.createTime===e},get initTime(){return we.initTime},get createTime(){return we.createTime},get loginTime(){return we.loginTime},get lastLogoutTime(){return parseInt(Bt.getItem(_e.LOGOUT_TIME))},get getReportCount(){return $t},get getReportFailedCount(){return Qt}},hn={get:function(e){var t="(^|)\\s*"+e+"=([^\\s]*)",n=He.cookie.match(new RegExp(t));return n&&n.length>=3?decodeURIComponent(n[2]):null},set:function(e,t,n,r,o,i){var c;n&&(c=new Date,c.setTime(c.getTime()+864e5*n));var a=n?" expires="+c.toGMTString():"",u=" path="+(o||"/"),s=r?" domain="+r:"",f=i?" secure":"";He.cookie=e+"="+encodeURIComponent(t)+a+u+s+f},remove:function(e,t,n){hn.set(e,"",-1,t,n)}},mn=Ce.hasCookie?hn:{get:Oe.noop,set:Oe.noop},bn=mn,jn=Pe.navigator;he.prototype.isIE=function(){return"Microsoft Internet Explorer"===jn.appName?!0:"Netscape"===jn.appName&&/Trident/.test(jn.userAgent)?!0:!1},he.prototype.getRegularPluginsString=function(){return this.map(jn.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")};var vn=Pe.screen;he.prototype.get=function(){var e=[];if(e.push(jn.userAgent),e.push(jn.language),e.push(vn.colorDepth),this.screen_resolution){var t=this.getScreenResolution();"undefined"!=typeof t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!Pe.indexedDB),He.body?e.push(typeof He.body.addBehavior):e.push("undefined"),e.push(typeof Pe.openDatabase),e.push(jn.cpuClass),e.push(jn.platform),e.push(jn.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},he.prototype.murmurhash3_32_gc=function(e,t){var n,r,o,i,c,a,u,s;for(n=3&e.length,r=e.length-n,o=t,c=3432918353,a=461845907,s=0;r>s;)u=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24,++s,u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=(65535&i)+27492+(((i>>>16)+58964&65535)<<16);switch(u=0,n){case 3:u^=(255&e.charCodeAt(s+2))<<16;break;case 2:u^=(255&e.charCodeAt(s+1))<<8;break;case 1:u^=255&e.charCodeAt(s),u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0},he.prototype.hasLocalStorage=function(){try{return!!Pe.localStorage}catch(e){return!0}},he.prototype.hasSessionStorage=function(){try{return!!Pe.sessionStorage}catch(e){return!0}},he.prototype.isCanvasSupported=function(){var e=He.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},he.prototype.getPluginsString=function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},he.prototype.getIEPluginsString=function(){if(Pe.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{return new Pe.ActiveXObject(e),e}catch(t){return null}}).join(";")}return""},he.prototype.getScreenResolution=function(){var e;return e=this.screen_orientation?vn.height>vn.width?[vn.height,vn.width]:[vn.width,vn.height]:[vn.height,vn.width]},he.prototype.getCanvasFingerprint=function(){var e=He.createElement("canvas"),t=e.getContext("2d"),n="http://www.dataeye.com/";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17),e.toDataURL()};var En=he;e.init=Ee,e.player=dn,e.isReady=ae});