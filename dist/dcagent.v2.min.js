!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.DCAgent={})}(this,function(e){"use strict";function t(){if(Ie)return Ie;if(Ve+=1,!(Ve>4)){var e={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"};for(var t in e){var n=e[t];if(n.indexOf(".")>-1){var r=n.split("."),o=Me[r[0]];if(o&&o[r[1]])return Ie=t,t}else if(Me[n])return Ie=t,t}}}function n(){}function r(e){return"function"==typeof e}function o(e){return e&&"[object Object]"===Ge.call(e)}function i(e){console.log("---- DCAgent log start ----\n"+e+"\n---- DCAgent log end   ----")}function c(e){var t,n,r;return t=Date.now(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r=n.replace(/[xy]/g,function(e){var n;return n=(t+16*Math.random())%16|0,t=Math.floor(t/16),"x"===e?n.toString(16):(7&n|8).toString(16)}),(e||"")+r.replace(/-/g,"").toUpperCase()}function a(e){var t,n;for(t in e)n=e[t],e[t]=n;var r=arguments.length>=2?[].slice.call(arguments,1):[];return r.forEach(function(r){var o;o=[];for(t in r)n=r[t],o.push(e[t]=n);return o}),e}function u(e){var t=".";try{return e.setItem(t,t),e.removeItem(t),!0}catch(n){return!1}}function s(e){for(var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n="",r=0;t>r;r+=1)n+=e;return n}function f(e,t,n){return e?e&&e.length>=n?e:e+s(t,Math.ceil(n-e.length)/t.length):e}function g(e,t,n){return function(){Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);var r,o;for(r=0;r<t.length;r+=1)if(o=t[r],He(o,this,arguments)===!1)return;var i=He(e,this,arguments);if(i===!1)return!1;for(r=0;r<n.length;r+=1)o=n[r],He(o,this,arguments);return i}}function l(e){if(!e)return"";var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return t?t[3]:""}function p(e,t,n){return[].slice.call(e,t,n)}function d(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return e>=1e21&&(e=9527e16),Me.parseInt(e,n)||t}function h(e){return Math.min(99e19,e)}function m(e){try{return e?JSON.stringify(e):null}catch(t){i("invalid json format")}return null}function b(e){try{return e?JSON.parse(e):null}catch(t){i("invalid json string")}return null}function j(){var e=Pe.loginTime||Pe.initTime;return{loginTime:e,onlineTime:ye.parseInt(Date.now()/1e3)-e||1,extendMap:{from:Pe.from,engine:t()||"",app:Pe.app}}}function v(e,t){var n={headerInfo:rt,onlineInfo:j(),errorInfoList:we.concat(),eventInfoList:ot.concat()};return e&&(n.paymentInfo=e),t&&(n.userInfo=t),n}function E(){ot.length=0,we.length=0}function T(){Kt.setItem(Se.LOGOUT_TIME,ye.parseInt(Date.now()/1e3)),(we.length||ot.length)&&Kt.setItem(Se.QUIT_SNAPSHOT,ye.jsonStringify(v()))}function I(){return ye.jsonParse(Kt.getItem(Se.QUIT_SNAPSHOT))}function O(e){it>=_e.MAX_ERROR_COUNT||(we.push(e),it+=1)}function y(e){ot.push(e)}function _(e,t){if(!e)return void ye.tryThrow("Missing eventId");var n=function(e){return e.replace(/%/g,"_")};arguments.length>2&&(t=arguments[2]);var r={};if(ye.isObject(t))for(var o in t)r[n(o)]="number"==typeof t[o]?t[o]:encodeURIComponent(t[o]);var i={eventId:n(e),eventMap:r};return Oe.addEvent(i),i}function S(){return rt.uid||""}function A(e,t){var n=this;this.duration=t,this.status="running",this.timer=Yt(function(){return n.run()},this.duration),this.run=function(){zt(n.timer),ye.attempt(e),n.timer=Yt(function(){return n.run()},n.duration)},this.stop=function(){n.status="stopped",zt(n.timer)},this.reset=function(e){n.stop(),e&&(n.duration=e),n.run()}}function C(e){qt&&(qt.stop(),Yt(function(){qt.reset(e)},e))}function L(e,t){qt=new A(e,t)}function N(){return qt}function x(e){var t=Me.egret,n=new t.URLLoader,r=Date.now();n.addEventListener(t.Event.COMPLETE,function(t){var n=Date.now()-r,o=t.target,i="success"===o.data;ye.attempt(i?e.success:e.error,o,[o,n,n>=e.timeout]),ye.attempt(e.complete,o,[o,n])});var o=new t.URLRequest(e.url);o.method=e.method||t.URLRequestMethod.POST,o.data=ye.jsonStringify(e.data),n.load(o)}function R(){return new Me.XMLHttpRequest}function D(){return Me.cc.loader.getXMLHttpRequest()}function w(e){var t=$t();t.timeout=e.timeout,t.open(e.method||"POST",e.url,!0),t.setRequestHeader("Content-Type","text/plain; charset=UTF-8");var n=Date.now();t.onreadystatechange=function(){if(4===this.readyState){var t=this.status>=200&&this.status<300,r=Date.now()-n;ye.attempt(t?e.success:e.error,this,[this,r]),ye.attempt(e.complete,this,[this,r]),this.onreadystatechange=null,this.ontimeout=null}},t.ontimeout=function(){var t=Date.now()-n;ye.attempt(e.error,this,[this,t,!0]),ye.attempt(e.complete,this,[this,t]),this.onreadystatechange=null,this.ontimeout=null},t.send(ye.jsonStringify(e.data))}function P(e,t){var n=Date.now();if(!t){if(n-tn<_e.ASAP_TIMEOUT)return void ye.tryThrow("Request dropped: rate limit");tn=n}en+=1,Zt({url:e.url,data:e.data,success:function(t,n){ye.attempt(e.success,t,[t,n])},error:function(t,n,r){Jt+=1,ye.attempt(e.error,t,[t,n,r])},complete:function(t,n){if(ye.attempt(e.complete,t,[t,n]),t.getAllResponseHeaders&&t.getResponseHeader){var r=t.getAllResponseHeaders(),o="X-Rate-Limit";if(-1!==r.indexOf(o)){var i=ye.parseInt(t.getResponseHeader(o));i>1&&Ae.reset(1e3*i)}}}})}function U(e){if(!e)return!1;var t=e.onlineInfo.onlineTime;return 1>t||t>_e.MAX_ONLINE_TIME?(ye.tryThrow("Illegal online time"),!1):!0}function M(){return Pe.inited?void 0:(ye.tryThrow("DCAgent.init needed"),!1)}function V(){return Pe.loginTime?void 0:(ye.tryThrow("DCAgent.login needed"),!1)}function G(){if(Be&&r(Be.createElement)){var e=Be.createElement("div");if(!e)return!1;if(r(e.querySelector)){e.innerHTML="<i></i>";var t=e.querySelector("i");return!!t&&"I"===t.tagName}if(r(e.getElementsByTagName)){var n=e.getElementsByTagName("i");return!!n&&1===n.length}}return!1}function F(e){return e+"?__deuid="+rt.uid+"&__deappid="+rt.appId}function k(e){return e+"?type=h520&appId="+rt.appId+"&uid="+rt.uid+"&mac="+(rt.mac||"")+"&imei="+(rt.imei||"")+"&idfa="+(rt.idfa||"")}function H(e,t,n){if(e||!ye.hiddenProperty||!Be[ye.hiddenProperty]){var r={url:Ne.appendOnline(an)};if(en&&en%Pe.oss===0&&Oe.addEvent({eventId:Se.REQ_KEY,eventMap:{succ:en-Jt,fail:Jt,total:en}}),r.data=Oe.collect(t,n),Ce.isParamsValid(r.data)){Oe.clear();var o=r.data.errorInfoList,i=r.data.eventInfoList;(i.length||o.length)&&(r.error=function(){o.forEach(function(e){Oe.addError(e)}),i.forEach(function(e){Oe.addEvent(e)})}),P(r,e)}}}function B(){var e=arguments.length<=0||void 0===arguments[0]?_e.ASAP_TIMEOUT:arguments[0];zt(Qt);var t=Ae.get();t.stop(),Qt=Yt(function(){t.run()},e)}function X(e){if(!e)return void ye.tryThrow("Missing accountID");if(rt.accountId===e)return void(Pe.loginTime=Pe.loginTime||ye.parseInt(Date.now()/1e3));var t=Ae.get();xe.setPollingDebounce(t.duration),H(!0),Pe.loginTime=ye.parseInt(Date.now()/1e3);var n=Se.ACCOUNT_RELATED_SETTINGS+","+Se.ACCOUNT_ROLE_SETTINGS;n.split(",").forEach(function(e){return rt[e]=""}),rt.age=_e.DEFAULT_AGE,rt.gender=_e.DEFAULT_GENDER,rt.roleLevel=_e.DEFAULT_ROLE_LEVEL,rt.accountId=e,H(!0)}function q(e,t,n,r){var o=arguments;Se.ACCOUNT_ROLE_SETTINGS.split(",").forEach(function(e,t){return rt[e]=o[t]||""}),rt.roleLevel=ye.parseInt(r)||1}function K(e,t,n,r){q(e,t,n,r),_("DE_EVENT_CREATE_ROLE",{roleId:String(e),roleRace:String(t),roleClass:String(n)})}function Y(e){rt.gender=2===e?2:1}function z(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];rt.gameServer=String(e)}function Q(e){e=ye.parseInt(e),rt.age=e>0&&128>e?e:0}function W(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];rt.accountType=String(e)}function J(e,t){_(Se.EVT_TASK,{actionType:"taskUnfinish",taskId:e,elapsed:ye.parseInt(t)})}function $(e,t){_(Se.EVT_TASK,{actionType:"taskFinish",taskId:e,elapsed:ye.parseInt(t)})}function Z(e){if(!e||!e.hasOwnProperty("amount"))return void ye.tryThrow("Missing amount");var t={currencyAmount:ye.max(parseFloat(e.amount,10)||0),currencyType:e.currencyType||"CNY",payType:String(e.payType||""),iapid:String(e.iapid||""),payTime:ye.parseInt(Date.now()/1e3),extendMap:{orderId:String(e.orderId||"")}};return H(!0,t),t}function ee(e,t){_(Se.EVT_MISSION,{actionType:"guankaUnfinish",guankaId:e,duration:ye.parseInt(t)})}function te(e,t){_(Se.EVT_MISSION,{actionType:"guankaFinish",guankaId:e,duration:ye.parseInt(t)})}function ne(e,t,n){t=ye.parseInt(t),rt.roleLevel=t,_(Se.EVT_LEVEL,{startLevel:ye.parseInt(e),endLevel:t,duration:ye.parseInt(n)})}function re(e,t,n,r){_(Se.EVT_ITEM,{actionType:"itemUse",itemId:e,itemNum:ye.parseInt(t),reason:r,missonID:n})}function oe(e,t,n,r){_(Se.EVT_ITEM,{actionType:"itemGet",itemId:e,itemNum:ye.parseInt(t),missonID:n,reason:r})}function ie(e,t,n,r,o){_(Se.EVT_ITEM,{actionType:"itemBuy",itemId:e,itemNum:ye.parseInt(t),coinType:n,coinNum:ye.parseInt(r),missonID:o})}function ce(e,t,n,r){_(Se.EVT_COIN,{actionType:"coinUse",coinType:n,balanceNum:ye.parseInt(t),coinNum:ye.parseInt(e),reason:r})}function ae(e,t,n,r){_(Se.EVT_COIN,{actionType:"coinGet",coinType:n,balanceNum:ye.parseInt(t),coinNum:ye.parseInt(e),reason:r})}function ue(){return Pe.inited}function se(){for(var e=["pagehide","beforeunload","unload"],t=0;t<e.length;t+=1)if("on"+e[t]in Me)return e[t]}function fe(e){if(Me.addEventListener){var t=se();t&&Me.addEventListener(t,e)}}function ge(){Me.addEventListener&&Me.addEventListener("error",function(e){ye.attempt(function(){var t={},n=["colno","filename","lineno","message"];n.forEach(function(n){return t[n]=e[n]||"1"});var r=e.error||{};if(t.stack=encodeURIComponent(r.stack||r.stacktrace||""),t.type=r.name||"Error",t.timestamp=parseInt(e.timeStamp/1e3),ye.isFunction(Pe.getErrorScene)){var o=ye.attempt(Pe.getErrorScene,r,[e]);if(o){if(ye.isObject(o)){var i="";for(var c in o)i+="	"+c+"="+o[c]+"\n";o=i}else o=String(o);t.stack+="\n\nError scene:\n"+encodeURIComponent(o)}}Oe.addError(t)})},!1)}function le(e){return Le.isStandardBrowser||Se.CLIENT_KEY===e?e:rt.appId+"."+e}function pe(e,t){e=le(e),Kt.setItem(e,t),vn.set(e,t,3650)}function de(e){return e=le(e),Kt.getItem(e)||vn.get(e)}function he(){var e=Date.now().toString(36).toUpperCase(),t=De.engine;return t.egret?Se.EGRET_PREFIX+e:t.layabox?Se.LAYA_PREFIX+e:t.cocos?Se.COCOS_PREFIX+e:Se.UNKNOW_ENGINE+e}function me(e){var t,n;t=Array.prototype.forEach,n=Array.prototype.map,this.each=function(e,n,r){if(null!==e)if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===+e.length){for(var o=0,i=e.length;i>o;o++)if(n.call(r,e[o],o,e)==={})return}else for(var c in e)if(e.hasOwnProperty(c)&&n.call(r,e[c],c,e)==={})return},this.map=function(e,t,r){var o=[];return null==e?o:n&&e.map===n?e.map(t,r):(this.each(e,function(e,n,i){o[o.length]=t.call(r,e,n,i)}),o)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)}function be(){var e;try{if(Le.isStandardBrowser)e=new In({canvas:!0,screen_resolution:!0,ie_activex:!0}).get().toString();else if(De.engine.layabox){var t=Me.layabox.getDeviceInfo()||{};e=t.mac||t.idfa,e=e&&e.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(n){e=null}return e=ye.padding(e,Se.PADDING_STRING,_e.UID_MIN_LENGTH),e||ye.uuid(he())}function je(e){if(rt.uid){var t=ye.padding(rt.uid,Se.PADDING_STRING,_e.UID_MIN_LENGTH);e!==t&&(rt.uid=t,e=t,Kt.setItem(Se.CREATE_TIME,ye.parseInt(Date.now()/1e3)))}var n=e||be();return Re.setItem(Se.CLIENT_KEY,n),n}function ve(e){var t=Re.getItem(Se.CLIENT_KEY),n=t?0:1,r=je(t);rt.uid=r,rt.accountId=r,e.errorReport&&ge(),Pe.initTime=ye.parseInt(Date.now()/1e3);var o=Kt.getItem(Se.CREATE_TIME);o||(o=Pe.initTime,Kt.setItem(Se.CREATE_TIME,o)),Pe.createTime=ye.parseInt(o);var i=Le.isStandardBrowser?on.href:"!";Oe.addEvent({eventId:Se.EVT_PV,eventMap:{page:encodeURI(i.split("?")[0])}});var c=n?{actTime:o,regTime:o}:null;H(!0,null,c),fe(Oe.saveToStorage);var a=ye.isDebug?_e.MIN_ONLINE_INTERVAL_DEBUG:_e.MIN_ONLINE_INTERVAL,u=1e3*Math.max(a,parseFloat(e.interval||a));Ae.set(H,u),Pe.inited=!0}function Ee(e){return ye.isLocalStorageSupported(Kt)?Pe.inited?"Initialization ignored":e&&e.appId?(e.appId=e.appId.toUpperCase(),Pe.oss="number"==typeof e.oss?e.oss:0,Pe.getErrorScene=e.getErrorScene,Pe.app=e.appName||"",Pe.from=e.from||ye.getHostName(Be.referrer),void Se.USER_INIT_BASE_SETTINGS.split(",").forEach(function(t){e.hasOwnProperty(t)&&(rt[t]=e[t])})):"Missing appId":Le.hasStorage?"Storage quota error":"Storage not support"}function Te(e){var t=Ee(e);return t?ye.tryThrow(t):(ve(e),void P({url:Ne.appendEcho(Le.protocol+"//"+Se.HOST+"/echo"),method:"GET"},!0))}var Ie,Oe={get getOnlineInfo(){return j},get collect(){return v},get clear(){return E},get saveToStorage(){return T},get loadFromStorage(){return I},get addError(){return O},get addEvent(){return y}},ye={get isDebug(){return Fe},get noop(){return n},get isFunction(){return r},get isObject(){return o},get log(){return i},get tryThrow(){return ke},get uuid(){return c},get extend(){return a},get attempt(){return He},get isLocalStorageSupported(){return u},get repeat(){return s},get padding(){return f},get aspect(){return g},get getHostName(){return l},get hiddenProperty(){return Xe},get slice(){return p},get parseInt(){return d},get max(){return h},get jsonStringify(){return m},get jsonParse(){return b}},_e={get REQUEST_TIME_OUT(){return qe},get MAX_ONLINE_TIME(){return Ke},get MIN_ONLINE_INTERVAL(){return Ye},get MIN_ONLINE_INTERVAL_DEBUG(){return ze},get UID_MIN_LENGTH(){return Qe},get ASAP_TIMEOUT(){return We},get MAX_ERROR_COUNT(){return Je},get DEFAULT_AGE(){return $e},get DEFAULT_GENDER(){return Ze},get DEFAULT_ROLE_LEVEL(){return et},get DEFAULT_NET_TYPE(){return tt},get DEFAULT_PLATFORM(){return nt}},Se={get HOST(){return Et},get CREATE_TIME(){return Tt},get EGRET_PREFIX(){return It},get LAYA_PREFIX(){return Ot},get COCOS_PREFIX(){return yt},get UNKNOW_ENGINE(){return _t},get PARENT_KEY(){return St},get EVENTS_KEY(){return At},get ERRORS_KEY(){return Ct},get CLIENT_KEY(){return Lt},get QUIT_SNAPSHOT(){return Nt},get LOGOUT_TIME(){return xt},get API_PATH(){return Rt},get PADDING_STRING(){return Dt},get REQ_KEY(){return wt},get USER_INIT_BASE_SETTINGS(){return Pt},get ACCOUNT_RELATED_SETTINGS(){return Ut},get ACCOUNT_ROLE_SETTINGS(){return Mt},get EVT_COIN(){return Vt},get EVT_ITEM(){return Gt},get EVT_LEVEL(){return Ft},get EVT_MISSION(){return kt},get EVT_TASK(){return Ht},get EVT_PV(){return Bt}},Ae={get reset(){return C},get set(){return L},get get(){return N}},Ce={get isParamsValid(){return U},get shouldBeInited(){return M},get shouldBeLoggedIn(){return V}},Le={get hasStorage(){return Xt},get isStandardBrowser(){return nn},get hasCookie(){return rn},get protocol(){return cn},get device(){return bt}},Ne={get appendOnline(){return F},get appendEcho(){return k}},xe={get setPollingDebounce(){return B}},Re={get setItem(){return pe},get getItem(){return de}},De={get engine(){return ft},get"default"(){return t}},we=[],Pe={inited:!1},Ue=(1,eval)("this"),Me=Ue||{},Ve=0,Ge=Object.prototype.toString,Fe=Me.DCAGENT_DEBUG_OPEN,ke=Fe?function(e){throw new Error(e)}:function(e){i(e)},He=Fe?function(e,t,n){return r(e)?e.apply(t,n):void 0}:function(e,t,n){if(r(e))try{return e.apply(t,n)}catch(o){i("exec error for function:\n "+e.toString())}},Be=Ue.document||{},Xe="hidden"in Be?"hidden":"webkitHidden"in Be?"webkitHidden":"mozHidden"in Be?"mozHidden":"msHidden"in Be?"msHidden":null;e.version=24;var qe=3e4,Ke=172800,Ye=40,ze=15,Qe=32,We=5e3,Je=100,$e=0,Ze=0,et=0,tt=3,nt=0,rt={accountId:"",accountType:"",age:_e.DEFAULT_AGE,appId:"",appVersion:"",brand:"",channel:"",customDeviceId:"",gameServer:"",gender:_e.DEFAULT_GENDER,idfa:"",imei:"",lonLat:"",mac:"",netType:_e.DEFAULT_NET_TYPE,operator:"",osVersion:"",platform:_e.DEFAULT_PLATFORM,resolution:"",roleClass:"",roleId:"",roleLevel:_e.DEFAULT_ROLE_LEVEL,roleRace:"",simCardOp:"",uid:"",ver:e.version},ot=[],it=0,ct=_e.DEFAULT_PLATFORM,at=Me.screen||{},ut=at.width&&at.width+"*"+at.height,st="0*0";ut||(ut=st);var ft={isEgret:!!Me.egret,isLayabox:!!Me.layabox,isCocos:!!Me.cc&&!!Me.cc.game},gt="",lt="",pt=Me.navigator&&Me.navigator.userAgent||"";if(!pt){var dt=["ios","android"];if(ft.layabox){var ht=Me.layabox.getDeviceInfo()||{};ut=ht.resolution||st,lt=ht.phonemodel,ct=dt.indexOf(ht.os.toLowerCase()),gt=(ht.os+" "+ht.osversion).toLowerCase()}else if(ft.cocos){var mt=Me.cc.view.getViewPortRect()||{};ut=mt.width+"*"+mt.height,ct=dt.indexOf(Me.cc.sys.os.toLowerCase())}-1===[0,1,2,3].indexOf(ct)&&(ct=_e.DEFAULT_PLATFORM)}var bt={resolution:ut,brand:lt,osVersion:gt,platform:ct};for(var jt in bt)rt[jt]=rt[jt]||bt[jt];var vt,Et="rd.gdatacube.net",Tt="dcagent_create_time",It="EGRET",Ot="LAYA",yt="COCOS",_t="UE",St="dcagent_parent_id",At="dcagent_client_events",Ct="dcagent_client_errors",Lt="dcagent_client_id",Nt="dcagent_snapshot",xt="dc_p_lo",Rt="/dc/hh5/sync",Dt="0A",wt="DE_EVENT_OSS",Pt="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",Ut="accountId,accountType,age,gender,gameServer",Mt="roleId,roleRace,roleClass,roleLevel",Vt="DE_EVENT_COIN_ACTION",Gt="DE_EVENT_ITEM_ACTION",Ft="DE_EVENT_LEVELUP",kt="DE_EVENT_GUANKA_ACTION",Ht="DE_EVENT_TASK_ACTION",Bt="DE_EVENT_PV",Xt=!!Me.localStorage||ft.isEgret||ft.isCocos||ft.isLayabox;vt=ft.isEgret?Me.egret.localStorage:ft.isCocos?Me.cc.sys.localStorage:Xt?Me.localStorage:{getItem:n,setItem:n,removeItem:n};var qt,Kt=vt,Yt=Me.setTimeout,zt=Me.clearTimeout;ft.isEgret&&(Yt=function(e,t){Me.egret.setTimeout(e,Me,t)},zt=function(e){Me.egret.clearTimeout(e)});var Qt,Wt,Jt=0,$t=ft.isCocos?D:R,Zt=function(){return Me.XMLHttpRequest||ft.isCocos?w:ft.isEgret?x:(ye.log("XMLHttpRequest not found"),ye.noop)}(),en=0,tn=Date.now()-_e.ASAP_TIMEOUT,nn=G(),rn=nn&&"cookie"in Be,on=Ue.location||{},cn="https:"===on.protocol?"https:":"http:",an=Le.protocol+"//"+Se.HOST+Se.API_PATH,un={login:X,getUid:S,onEvent:_},sn={onCoinGet:ae,onCoinUse:ce,onItemBuy:ie,onItemProduce:oe,onItemUse:re,onLevelUp:ne,onMissionFinished:te,onMissionUnfinished:ee,onPayment:Z,onTaskFinished:$,onTaskUnfinished:J,setAccountType:W,setAge:Q,setGameServer:z,setGender:Y,setRoleInfo:q,createRole:K},fn=[Ce.shouldBeInited],gn=[Ce.shouldBeLoggedIn],ln=[xe.setPollingDebounce];for(Wt in un)e[Wt]=ye.aspect(un[Wt],fn,"onEvent"===Wt&&ln);for(Wt in sn)e[Wt]=ye.aspect(sn[Wt],gn,"onPayment"!==Wt&&ln);var pn=Me.DCAgentObject;if(pn){var dn=Me[pn];if(ye.isFunction(dn)){var hn=dn.cache;hn.length&&(hn.forEach(function(t){ye.attempt(e[t[0]],e,ye.slice(t,1))}),hn.length=0)}}var mn={get isNew(){var e=Pe.loginTime||Pe.initTime;return Pe.createTime===e},get initTime(){return Pe.initTime},get createTime(){return Pe.createTime},get loginTime(){return Pe.loginTime},get lastLogoutTime(){return parseInt(Kt.getItem(Se.LOGOUT_TIME))},get reportCount(){return en},get reportFailedCount(){return Jt}},bn={get:function(e){var t="(^|)\\s*"+e+"=([^\\s]*)",n=Be.cookie.match(new RegExp(t));return n&&n.length>=3?decodeURIComponent(n[2]):null},set:function(e,t,n,r,o,i){var c;n&&(c=new Date,c.setTime(c.getTime()+864e5*n));var a=n?" expires="+c.toGMTString():"",u=" path="+(o||"/"),s=r?" domain="+r:"",f=i?" secure":"";Be.cookie=e+"="+encodeURIComponent(t)+a+u+s+f},remove:function(e,t,n){bn.set(e,"",-1,t,n)}},jn=Le.hasCookie?bn:{get:ye.noop,set:ye.noop},vn=jn,En=Me.navigator;me.prototype.isIE=function(){return"Microsoft Internet Explorer"===En.appName?!0:"Netscape"===En.appName&&/Trident/.test(En.userAgent)?!0:!1},me.prototype.getRegularPluginsString=function(){return this.map(En.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")};var Tn=Me.screen;me.prototype.get=function(){var e=[];if(e.push(En.userAgent),e.push(En.language),e.push(Tn.colorDepth),this.screen_resolution){var t=this.getScreenResolution();"undefined"!=typeof t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!Me.indexedDB),Be.body?e.push(typeof Be.body.addBehavior):e.push("undefined"),e.push(typeof Me.openDatabase),e.push(En.cpuClass),e.push(En.platform),e.push(En.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},me.prototype.murmurhash3_32_gc=function(e,t){var n,r,o,i,c,a,u,s;for(n=3&e.length,r=e.length-n,o=t,c=3432918353,a=461845907,s=0;r>s;)u=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24,++s,u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=(65535&i)+27492+(((i>>>16)+58964&65535)<<16);switch(u=0,n){case 3:u^=(255&e.charCodeAt(s+2))<<16;break;case 2:u^=(255&e.charCodeAt(s+1))<<8;break;case 1:u^=255&e.charCodeAt(s),u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0},me.prototype.hasLocalStorage=function(){try{return!!Me.localStorage}catch(e){return!0}},me.prototype.hasSessionStorage=function(){try{return!!Me.sessionStorage}catch(e){return!0}},me.prototype.isCanvasSupported=function(){var e=Be.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},me.prototype.getPluginsString=function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},me.prototype.getIEPluginsString=function(){if(Me.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{return new Me.ActiveXObject(e),e}catch(t){return null}}).join(";")}return""},me.prototype.getScreenResolution=function(){var e;return e=this.screen_orientation?Tn.height>Tn.width?[Tn.height,Tn.width]:[Tn.width,Tn.height]:[Tn.height,Tn.width]},me.prototype.getCanvasFingerprint=function(){var e=Be.createElement("canvas"),t=e.getContext("2d"),n="http://www.dataeye.com/";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17),e.toDataURL()};var In=me;e.init=Te,e.player=mn,e.isReady=ue});