!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.DCAgent={})}(this,function(e){"use strict";function t(){if(ve)return ve;if(De+=1,!(De>4)){var e={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"};for(var t in e){var n=e[t];if(n.indexOf(".")>-1){var r=n.split("."),o=we[r[0]];if(o&&o[r[1]])return ve=t,t}else if(we[n])return ve=t,t}}}function n(){}function r(e){return"function"==typeof e}function o(e){return e&&"[object Object]"===Ue.call(e)}function i(e){console.log("---- DCAgent log start ----\n"+e+"\n---- DCAgent log end   ----")}function c(e){var t,n,r;return t=Date.now(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r=n.replace(/[xy]/g,function(e){var n;return n=(t+16*Math.random())%16|0,t=Math.floor(t/16),"x"===e?n.toString(16):(7&n|8).toString(16)}),(e||"")+r.replace(/-/g,"").toUpperCase()}function a(e){var t,n;for(t in e)n=e[t],e[t]=n;var r=arguments.length>=2?[].slice.call(arguments,1):[];return r.forEach(function(r){var o;o=[];for(t in r)n=r[t],o.push(e[t]=n);return o}),e}function u(e){var t=".";try{return e.setItem(t,t),e.removeItem(t),!0}catch(n){return!1}}function s(e){for(var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n="",r=0;t>r;r+=1)n+=e;return n}function f(e,t,n){return e?e&&e.length>=n?e:e+s(t,Math.ceil(n-e.length)/t.length):e}function g(e,t,n){return function(){Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);var r,o;for(r=0;r<t.length;r+=1)if(o=t[r],Ve(o,this,arguments)===!1)return;var i=Ve(e,this,arguments);if(i===!1)return!1;for(r=0;r<n.length;r+=1)o=n[r],Ve(o,this,arguments);return i}}function l(e){if(!e)return"";var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return t?t[3]:""}function p(e,t,n){return[].slice.call(e,t,n)}function d(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return e>=1e21&&(e=9527e16),we.parseInt(e,n)||t}function h(e){try{return e?JSON.stringify(e):null}catch(t){i("invalid json format")}return null}function m(e){try{return e?JSON.parse(e):null}catch(t){i("invalid json string")}return null}function b(){var e=xe.loginTime||xe.initTime;return{loginTime:e,onlineTime:Te.parseInt(Date.now()/1e3)-e||1,extendMap:{from:xe.from,engine:t()||"",app:xe.app}}}function j(e,t){var n={headerInfo:$e,onlineInfo:b(),errorInfoList:Ne.concat(),eventInfoList:Ze.concat()};return e&&(n.paymentInfo=e),t&&(n.userInfo=t),n}function v(){Ze.length=0,Ne.length=0}function E(){kt.setItem(Oe.LOGOUT_TIME,Te.parseInt(Date.now()/1e3)),(Ne.length||Ze.length)&&kt.setItem(Oe.QUIT_SNAPSHOT,Te.jsonStringify(j()))}function T(){return Te.jsonParse(kt.getItem(Oe.QUIT_SNAPSHOT))}function I(e){et>=Ie.MAX_ERROR_COUNT||(Ne.push(e),et+=1)}function O(e){Ze.push(e)}function y(e,t){if(!e)return Te.tryThrow("Missing eventId"),!1;arguments.length>2&&(t=arguments[2]);var n={};if(Te.isObject(t))for(var r in t)n[r.replace("%","_")]="number"==typeof t[r]?t[r]:encodeURIComponent(t[r]);return Ee.addEvent({eventId:e,eventMap:n}),!0}function _(){return $e.uid||""}function S(e,t){var n=this;this.duration=t,this.status="running",this.timer=Ht(function(){return n.run()},this.duration),this.run=function(){Bt(n.timer),Te.attempt(e),n.timer=Ht(function(){return n.run()},n.duration)},this.stop=function(){n.status="stopped",Bt(n.timer)},this.reset=function(e){n.stop(),e&&(n.duration=e),n.run()}}function A(e){Gt&&(Gt.stop(),Ht(function(){Gt.reset(e)},e))}function C(e,t){Gt=new S(e,t)}function L(){return Gt}function N(e){var t=we.egret,n=new t.URLLoader,r=Date.now();n.addEventListener(t.Event.COMPLETE,function(t){var n=Date.now()-r,o=t.target,i="success"===o.data;Te.attempt(i?e.success:e.error,o,[o,n,n>=e.timeout]),Te.attempt(e.complete,o,[o,n])});var o=new t.URLRequest(e.url);o.method=e.method||t.URLRequestMethod.POST,o.data=Te.jsonStringify(e.data),n.load(o)}function x(){return new we.XMLHttpRequest}function R(){return we.cc.loader.getXMLHttpRequest()}function w(e){var t=Yt();t.timeout=e.timeout,t.open(e.method||"POST",e.url,!0),t.setRequestHeader("Content-Type","text/plain; charset=UTF-8");var n=Date.now();t.onreadystatechange=function(){if(4===this.readyState){var t=this.status>=200&&this.status<300,r=Date.now()-n;Te.attempt(t?e.success:e.error,this,[this,r]),Te.attempt(e.complete,this,[this,r]),this.onreadystatechange=null,this.ontimeout=null}},t.ontimeout=function(){var t=Date.now()-n;Te.attempt(e.error,this,[this,t,!0]),Te.attempt(e.complete,this,[this,t]),this.onreadystatechange=null,this.ontimeout=null},t.send(Te.jsonStringify(e.data))}function D(e,t){var n=Date.now();if(!t){if(Wt&&n-Wt<Ie.ASAP_TIMEOUT)return void Te.tryThrow("Request dropped: unexpected behavior");Wt=n}Qt+=1,zt({url:e.url,data:e.data,success:function(t,n){Te.attempt(e.success,t,[t,n])},error:function(t,n,r){Kt+=1,Te.attempt(e.error,t,[t,n,r])},complete:function(t,n){if(Te.attempt(e.complete,t,[t,n]),t.getAllResponseHeaders&&t.getResponseHeader){var r=t.getAllResponseHeaders(),o="X-Rate-Limit";if(-1!==r.indexOf(o)){var i=Te.parseInt(t.getResponseHeader(o));i>1&&ye.reset(1e3*i)}}}})}function U(e){if(!e)return!1;var t=e.onlineInfo.onlineTime;return 1>t||t>Ie.MAX_ONLINE_TIME?(Te.tryThrow("Illegal online time"),!1):!0}function P(){return xe.inited?void 0:(Te.tryThrow("DCAgent.init needed"),!1)}function M(){return xe.loginTime?void 0:(Te.tryThrow("DCAgent.login needed"),!1)}function V(){if(Fe&&r(Fe.createElement)){var e=Fe.createElement("div");if(!e)return!1;if(r(e.querySelector)){e.innerHTML="<i></i>";var t=e.querySelector("i");return!!t&&"I"===t.tagName}if(r(e.getElementsByTagName)){var n=e.getElementsByTagName("i");return!!n&&1===n.length}}return!1}function F(e,t,n){if(e||!Te.hiddenProperty||!Fe[Te.hiddenProperty]){var r={url:tn};if(Qt&&Qt%$e.oss===0&&Ee.addEvent({eventId:Oe.REQ_KEY,eventMap:{succ:Qt-Kt,fail:Kt,total:Qt}}),r.data=Ee.collect(t,n),_e.isParamsValid(r.data)){Ee.clear();var o=r.data.errorInfoList,i=r.data.eventInfoList;(i.length||o.length)&&(r.error=function(){o.forEach(function(e){Ee.addError(e)}),i.forEach(function(e){Ee.addEvent(e)})}),D(r,e)}}}function G(e){if(!e)return void Te.tryThrow("Missing accountID");if(xe.loginTime=Te.parseInt(Date.now()/1e3),$e.accountId!==e){var t=ye.get();t.stop(),F(!0);var n=Oe.ACCOUNT_RELATED_SETTINGS+","+Oe.ACCOUNT_ROLE_SETTINGS;n.split(",").forEach(function(e){return $e[e]=""}),$e.age=Ie.DEFAULT_AGE,$e.gender=Ie.DEFAULT_GENDER,$e.roleLevel=Ie.DEFAULT_ROLE_LEVEL,$e.accountId=e,t.reset()}}function k(){console.log("debounce"),Bt(Xt);var e=ye.get();e.stop(),Xt=Ht(function(){e.run()},Ie.ASAP_TIMEOUT)}function H(e,t,n,r){var o=arguments;Oe.ACCOUNT_ROLE_SETTINGS.split(",").forEach(function(e,t){return $e[e]=o[t]||""}),$e.roleLevel=Te.parseInt(r)||1}function B(e,t,n,r){H(e,t,n,r),y("DE_EVENT_CREATE_ROLE",{roleId:String(e),roleRace:String(t),roleClass:String(n)})}function X(e){$e.gender=2===e?2:1}function q(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];$e.gameServer=String(e)}function K(e){e=Te.parseInt(e),$e.age=e>0&&128>e?e:0}function Y(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];$e.accountType=String(e)}function z(e,t){y(Oe.EVT_TASK,{actionType:"taskUnfinish",taskId:e,elapsed:Te.parseInt(t)})}function Q(e,t){y(Oe.EVT_TASK,{actionType:"taskFinish",taskId:e,elapsed:Te.parseInt(t)})}function W(e){e&&e.hasOwnProperty("amount")&&F(!0,{currencyAmount:parseFloat(e.amount,10)||0,currencyType:e.currencyType||"CNY",payType:String(e.payType||""),iapid:String(e.iapid||""),payTime:Te.parseInt(Date.now()/1e3),extendMap:{orderId:String(e.orderId||"")}})}function J(e,t){y(Oe.EVT_MISSION,{actionType:"guankaUnfinish",guankaId:e,duration:Te.parseInt(t)})}function $(e,t){y(Oe.EVT_MISSION,{actionType:"guankaFinish",guankaId:e,duration:Te.parseInt(t)})}function Z(e,t,n){t=Te.parseInt(t),$e.roleLevel=t,y(Oe.EVT_LEVEL,{startLevel:Te.parseInt(e),endLevel:t,duration:Te.parseInt(n)})}function ee(e,t,n,r){y(Oe.EVT_ITEM,{actionType:"itemUse",itemId:e,itemNum:Te.parseInt(t),reason:r,missonID:n})}function te(e,t,n,r){y(Oe.EVT_ITEM,{actionType:"itemGet",itemId:e,itemNum:Te.parseInt(t),missonID:n,reason:r})}function ne(e,t,n,r,o){y(Oe.EVT_ITEM,{actionType:"itemBuy",itemId:e,itemNum:Te.parseInt(t),coinType:n,coinNum:Te.parseInt(r),missonID:o})}function re(e,t,n,r){y(Oe.EVT_COIN,{actionType:"coinUse",coinType:n,balanceNum:Te.parseInt(t),coinNum:Te.parseInt(e),reason:r})}function oe(e,t,n,r){y(Oe.EVT_COIN,{actionType:"coinGet",coinType:n,balanceNum:Te.parseInt(t),coinNum:Te.parseInt(e),reason:r})}function ie(){return xe.inited}function ce(){for(var e=["pagehide","beforeunload","unload"],t=0;t<e.length;t+=1)if("on"+e[t]in we)return e[t]}function ae(e){if(we.addEventListener){var t=ce();t&&we.addEventListener(t,e)}}function ue(){we.addEventListener&&we.addEventListener("error",function(e){Te.attempt(function(){var t={},n=["colno","filename","lineno","message"];n.forEach(function(n){return t[n]=e[n]||"1"});var r=e.error||{};if(t.stack=encodeURIComponent(r.stack||r.stacktrace||""),t.type=r.name||"Error",t.timestamp=parseInt(e.timeStamp/1e3),Te.isFunction(xe.getErrorScene)){var o=Te.attempt(xe.getErrorScene,r,[e]);if(o){if(Te.isObject(o)){var i="";for(var c in o)i+="	"+c+"="+o[c]+"\n";o=i}else o=String(o);t.stack+="\n\nError scene:\n"+encodeURIComponent(o)}}Ee.addError(t)})},!1)}function se(e){return Se.isStandardBrowser||Oe.CLIENT_KEY===e?e:$e.appId+"."+e}function fe(e,t){e=se(e),kt.setItem(e,t),dn.set(e,t,3650)}function ge(e){return e=se(e),kt.getItem(e)||dn.get(e)}function le(){var e=Date.now().toString(36).toUpperCase(),t=Le.engine;return t.egret?Oe.EGRET_PREFIX+e:t.layabox?Oe.LAYA_PREFIX+e:t.cocos?Oe.COCOS_PREFIX+e:Oe.UNKNOW_ENGINE+e}function pe(e){var t,n;t=Array.prototype.forEach,n=Array.prototype.map,this.each=function(e,n,r){if(null!==e)if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===+e.length){for(var o=0,i=e.length;i>o;o++)if(n.call(r,e[o],o,e)==={})return}else for(var c in e)if(e.hasOwnProperty(c)&&n.call(r,e[c],c,e)==={})return},this.map=function(e,t,r){var o=[];return null==e?o:n&&e.map===n?e.map(t,r):(this.each(e,function(e,n,i){o[o.length]=t.call(r,e,n,i)}),o)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)}function de(){var e;try{if(Se.isStandardBrowser)e=new bn({canvas:!0,screen_resolution:!0,ie_activex:!0}).get().toString();else if(Le.engine.layabox){var t=we.layabox.getDeviceInfo()||{};e=t.mac||t.idfa,e=e&&e.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(n){e=null}return e=Te.padding(e,Oe.PADDING_STRING,Ie.UID_MIN_LENGTH),e||Te.uuid(le())}function he(e){if($e.uid){var t=Te.padding($e.uid,Oe.PADDING_STRING,Ie.UID_MIN_LENGTH);e!==t&&($e.uid=t,e=t,kt.setItem(Oe.CREATE_TIME,Te.parseInt(Date.now()/1e3)))}var n=e||de();return Ce.setItem(Oe.CLIENT_KEY,n),n}function me(e){var t=Ce.getItem(Oe.CLIENT_KEY),n=t?0:1,r=he(t);$e.uid=r,$e.accountId=r,e.errorReport&&ue(),xe.initTime=Te.parseInt(Date.now()/1e3);var o=kt.getItem(Oe.CREATE_TIME);o||(o=xe.initTime,kt.setItem(Oe.CREATE_TIME,o)),xe.createTime=Te.parseInt(o);var i=Se.isStandardBrowser?Zt.href:"!";Ee.addEvent({eventId:Oe.EVT_PV,eventMap:{page:encodeURI(i.split("?")[0])}});var c=n?{actTime:o,regTime:o}:null;F(!0,null,c),ae(Ee.saveToStorage);var a=1e3*Math.max(Ie.MIN_ONLINE_INTERVAL,parseFloat(e.interval||Ie.MIN_ONLINE_INTERVAL));return ye.set(F,a),xe.inited=!0,!0}function be(e){return Te.isLocalStorageSupported(kt)?xe.inited?void Te.tryThrow("Initialization ignored"):e&&e.appId?(e.appId=e.appId.toUpperCase(),xe.oss="number"==typeof e.oss?e.oss:0,xe.getErrorScene=e.getErrorScene,xe.app=e.appName||"",xe.from=e.from||Te.getHostName(Fe.referrer),Oe.USER_INIT_BASE_SETTINGS.split(",").forEach(function(t){e.hasOwnProperty(t)&&($e[t]=e[t])}),!0):void Te.tryThrow("Missing appId"):void Te.tryThrow(Se.hasStorage?"Storage quota error":"Storage not support")}function je(e){var t=be(e);return t?me(e):!1}var ve,Ee={get getOnlineInfo(){return b},get collect(){return j},get clear(){return v},get saveToStorage(){return E},get loadFromStorage(){return T},get addError(){return I},get addEvent(){return O}},Te={get noop(){return n},get isFunction(){return r},get isObject(){return o},get log(){return i},get tryThrow(){return Me},get uuid(){return c},get extend(){return a},get attempt(){return Ve},get isLocalStorageSupported(){return u},get repeat(){return s},get padding(){return f},get aspect(){return g},get getHostName(){return l},get hiddenProperty(){return Ge},get slice(){return p},get parseInt(){return d},get jsonStringify(){return h},get jsonParse(){return m}},Ie={get REQUEST_TIME_OUT(){return ke},get MAX_ONLINE_TIME(){return He},get MIN_ONLINE_INTERVAL(){return Be},get UID_MIN_LENGTH(){return Xe},get ASAP_TIMEOUT(){return qe},get MAX_ERROR_COUNT(){return Ke},get DEFAULT_AGE(){return Ye},get DEFAULT_GENDER(){return ze},get DEFAULT_ROLE_LEVEL(){return Qe},get DEFAULT_NET_TYPE(){return We},get DEFAULT_PLATFORM(){return Je}},Oe={get HOST(){return ht},get CREATE_TIME(){return mt},get EGRET_PREFIX(){return bt},get LAYA_PREFIX(){return jt},get COCOS_PREFIX(){return vt},get UNKNOW_ENGINE(){return Et},get PARENT_KEY(){return Tt},get EVENTS_KEY(){return It},get ERRORS_KEY(){return Ot},get CLIENT_KEY(){return yt},get QUIT_SNAPSHOT(){return _t},get LOGOUT_TIME(){return St},get API_PATH(){return At},get PADDING_STRING(){return Ct},get REQ_KEY(){return Lt},get USER_INIT_BASE_SETTINGS(){return Nt},get ACCOUNT_RELATED_SETTINGS(){return xt},get ACCOUNT_ROLE_SETTINGS(){return Rt},get EVT_COIN(){return wt},get EVT_ITEM(){return Dt},get EVT_LEVEL(){return Ut},get EVT_MISSION(){return Pt},get EVT_TASK(){return Mt},get EVT_PV(){return Vt}},ye={get reset(){return A},get set(){return C},get get(){return L}},_e={get isParamsValid(){return U},get shouldBeInited(){return P},get shouldBeLoggedIn(){return M}},Se={get hasStorage(){return Ft},get isStandardBrowser(){return Jt},get hasCookie(){return $t},get protocol(){return en},get device(){return lt}},Ae={get debounce(){return k}},Ce={get setItem(){return fe},get getItem(){return ge}},Le={get engine(){return it},get"default"(){return t}},Ne=[],xe={inited:!1},Re=(1,eval)("this"),we=Re||{},De=0,Ue=Object.prototype.toString,Pe=we.DCAGENT_DEBUG_OPEN,Me=Pe?function(e){throw new Error(e)}:function(e){i(e)},Ve=Pe?function(e,t,n){return r(e)?e.apply(t,n):void 0}:function(e,t,n){if(r(e))try{return e.apply(t,n)}catch(o){i("exec error for function:\n "+e.toString())}},Fe=Re.document||{},Ge="hidden"in Fe?"hidden":"webkitHidden"in Fe?"webkitHidden":"mozHidden"in Fe?"mozHidden":"msHidden"in Fe?"msHidden":null;e.version=24;var ke=3e4,He=172800,Be=40,Xe=32,qe=5e3,Ke=100,Ye=0,ze=0,Qe=0,We=3,Je=0,$e={accountId:"",accountType:"",age:Ie.DEFAULT_AGE,appId:"",appVersion:"",brand:"",channel:"",customDeviceId:"",gameServer:"",gender:Ie.DEFAULT_GENDER,idfa:"",imei:"",lonLat:"",mac:"",netType:Ie.DEFAULT_NET_TYPE,operator:"",osVersion:"",platform:Ie.DEFAULT_PLATFORM,resolution:"",roleClass:"",roleId:"",roleLevel:Ie.DEFAULT_ROLE_LEVEL,roleRace:"",simCardOp:"",uid:"",ver:e.version},Ze=[],et=0,tt=Ie.DEFAULT_PLATFORM,nt=we.screen||{},rt=nt.width&&nt.width+"*"+nt.height,ot="0*0";rt||(rt=ot);var it={isEgret:!!we.egret,isLayabox:!!we.layabox,isCocos:!!we.cc&&!!we.cc.game},ct="",at="",ut=we.navigator&&we.navigator.userAgent||"";if(!ut){var st=["ios","android"];if(it.layabox){var ft=we.layabox.getDeviceInfo()||{};rt=ft.resolution||ot,at=ft.phonemodel,tt=st.indexOf(ft.os.toLowerCase()),ct=(ft.os+" "+ft.osversion).toLowerCase()}else if(it.cocos){var gt=we.cc.view.getViewPortRect()||{};rt=gt.width+"*"+gt.height,tt=st.indexOf(we.cc.sys.os.toLowerCase())}-1===[0,1,2,3].indexOf(tt)&&(tt=Ie.DEFAULT_PLATFORM)}var lt={resolution:rt,brand:at,osVersion:ct,platform:tt};for(var pt in lt)$e[pt]=$e[pt]||lt[pt];var dt,ht="rd.gdatacube.net",mt="dcagent_create_time",bt="EGRET",jt="LAYA",vt="COCOS",Et="UE",Tt="dcagent_parent_id",It="dcagent_client_events",Ot="dcagent_client_errors",yt="dcagent_client_id",_t="dcagent_snapshot",St="dc_p_lo",At="/dc/hh5/sync",Ct="0A",Lt="DE_EVENT_OSS",Nt="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",xt="accountId,accountType,age,gender,gameServer",Rt="roleId,roleRace,roleClass,roleLevel",wt="DE_EVENT_COIN_ACTION",Dt="DE_EVENT_ITEM_ACTION",Ut="DE_EVENT_LEVELUP",Pt="DE_EVENT_GUANKA_ACTION",Mt="DE_EVENT_TASK_ACTION",Vt="DE_EVENT_PV",Ft=!!we.localStorage||it.isEgret||it.isCocos||it.isLayabox;dt=it.isEgret?we.egret.localStorage:it.isCocos?we.cc.sys.localStorage:Ft?we.localStorage:{getItem:n,setItem:n,removeItem:n};var Gt,kt=dt,Ht=we.setTimeout,Bt=we.clearTimeout;it.isEgret&&(Ht=function(e,t){we.egret.setTimeout(e,we,t)},Bt=function(e){we.egret.clearTimeout(e)});var Xt,qt,Kt=0,Yt=it.isCocos?R:x,zt=function(){return we.XMLHttpRequest||it.isCocos?w:it.isEgret?N:(Te.log("XMLHttpRequest not found"),Te.noop)}(),Qt=0,Wt=0,Jt=V(),$t=Jt&&"cookie"in Fe,Zt=Re.location||{},en="https:"===Zt.protocol?"https:":"http:",tn=Se.protocol+"//"+Oe.HOST+Oe.API_PATH,nn={login:G,getUid:_,onEvent:y},rn={onCoinGet:oe,onCoinUse:re,onItemBuy:ne,onItemProduce:te,onItemUse:ee,onLevelUp:Z,onMissionFinished:$,onMissionUnfinished:J,onPayment:W,onTaskFinished:Q,onTaskUnfinished:z,setAccountType:Y,setAge:K,setGameServer:q,setGender:X,setRoleInfo:H,createRole:B},on=[_e.shouldBeInited],cn=[_e.shouldBeLoggedIn],an=[Ae.debounce];for(qt in nn)e[qt]=Te.aspect(nn[qt],on,"onEvent"===qt&&an);for(qt in rn)e[qt]=Te.aspect(rn[qt],cn,"onPayment"!==qt&&an);var un=we.DCAgentObject;if(un){var sn=we[un];if(Te.isFunction(sn)){var fn=sn.cache;fn.length&&(fn.forEach(function(t){Te.attempt(e[t[0]],e,Te.slice(t,1))}),fn.length=0)}}var gn={get isNew(){var e=xe.loginTime||xe.initTime;return xe.createTime===e},get initTime(){return xe.initTime},get createTime(){return xe.createTime},get loginTime(){return xe.loginTime},get lastLogoutTime(){return parseInt(kt.getItem(Oe.LOGOUT_TIME))},get getReportCount(){return Qt},get getReportFailedCount(){return Kt}},ln={get:function(e){var t="(^|)\\s*"+e+"=([^\\s]*)",n=Fe.cookie.match(new RegExp(t));return n&&n.length>=3?decodeURIComponent(n[2]):null},set:function(e,t,n,r,o,i){var c;n&&(c=new Date,c.setTime(c.getTime()+864e5*n));var a=n?" expires="+c.toGMTString():"",u=" path="+(o||"/"),s=r?" domain="+r:"",f=i?" secure":"";Fe.cookie=e+"="+encodeURIComponent(t)+a+u+s+f},remove:function(e,t,n){ln.set(e,"",-1,t,n)}},pn=Se.hasCookie?ln:{get:Te.noop,set:Te.noop},dn=pn,hn=we.navigator;pe.prototype.isIE=function(){return"Microsoft Internet Explorer"===hn.appName?!0:"Netscape"===hn.appName&&/Trident/.test(hn.userAgent)?!0:!1},pe.prototype.getRegularPluginsString=function(){return this.map(hn.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")};var mn=we.screen;pe.prototype.get=function(){var e=[];if(e.push(hn.userAgent),e.push(hn.language),e.push(mn.colorDepth),this.screen_resolution){var t=this.getScreenResolution();"undefined"!=typeof t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!we.indexedDB),Fe.body?e.push(typeof Fe.body.addBehavior):e.push("undefined"),e.push(typeof we.openDatabase),e.push(hn.cpuClass),e.push(hn.platform),e.push(hn.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},pe.prototype.murmurhash3_32_gc=function(e,t){var n,r,o,i,c,a,u,s;for(n=3&e.length,r=e.length-n,o=t,c=3432918353,a=461845907,s=0;r>s;)u=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24,++s,u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=(65535&i)+27492+(((i>>>16)+58964&65535)<<16);switch(u=0,n){case 3:u^=(255&e.charCodeAt(s+2))<<16;break;case 2:u^=(255&e.charCodeAt(s+1))<<8;break;case 1:u^=255&e.charCodeAt(s),u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0},pe.prototype.hasLocalStorage=function(){try{return!!we.localStorage}catch(e){return!0}},pe.prototype.hasSessionStorage=function(){try{return!!we.sessionStorage}catch(e){return!0}},pe.prototype.isCanvasSupported=function(){var e=Fe.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},pe.prototype.getPluginsString=function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},pe.prototype.getIEPluginsString=function(){if(we.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{return new we.ActiveXObject(e),e}catch(t){return null}}).join(";")}return""},pe.prototype.getScreenResolution=function(){var e;return e=this.screen_orientation?mn.height>mn.width?[mn.height,mn.width]:[mn.width,mn.height]:[mn.height,mn.width]},pe.prototype.getCanvasFingerprint=function(){var e=Fe.createElement("canvas"),t=e.getContext("2d"),n="http://www.dataeye.com/";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17),e.toDataURL()};var bn=pe;e.init=je,e.player=gn,e.isReady=ie});