!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.DCAgent={})}(this,function(t){"use strict";function e(){if(Ot)return Ot;if(Ft+=1,!(Ft>4)){var t={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"};for(var e in t){var n=t[e];if(n.indexOf(".")>-1){var r=n.split("."),o=Vt[r[0]];if(o&&o[r[1]])return Ot=e,e}else if(Vt[n])return Ot=e,e}}}function n(){}function r(t){return"function"==typeof t}function o(t){return t&&"[object Object]"===Gt.call(t)}function i(t){console.log("---- DCAgent log start ----\n"+t+"\n---- DCAgent log end   ----")}function c(t){var e,n,r;return e=Date.now(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r=n.replace(/[xy]/g,function(t){var n;return n=(e+16*Math.random())%16|0,e=Math.floor(e/16),"x"===t?n.toString(16):(7&n|8).toString(16)}),(t||"")+r.replace(/-/g,"").toUpperCase()}function a(t){var e,n;for(e in t)n=t[e],t[e]=n;var r=arguments.length>=2?[].slice.call(arguments,1):[];return r.forEach(function(r){var o;o=[];for(e in r)n=r[e],o.push(t[e]=n);return o}),t}function u(t){return Xt(function(){var e="0";t.setItem(e,e);var n=t.getItem(e)===e;return t.removeItem(e),n})}function s(t){for(var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n="",r=0;e>r;r+=1)n+=t;return n}function g(t,e,n){return t?t&&t.length>=n?t:t+s(e,Math.ceil(n-t.length)/e.length):t}function f(t,e,n){return function(){Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);var r,o;for(r=0;r<e.length;r+=1)if(o=e[r],Xt(o,this,arguments)===!1)return;var i=Xt(t,this,arguments);if(i===!1)return!1;for(r=0;r<n.length;r+=1)o=n[r],Xt(o,this,arguments);return i}}function l(t){if(!t)return"";var e=t.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return e?e[3]:""}function p(t,e,n){return[].slice.call(t,e,n)}function d(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return t>=1e21&&(t=9527e16),Vt.parseInt(t,n)||e}function h(t){return Math.min(99e19,t)}function m(t){try{return t?JSON.stringify(t):null}catch(e){i("invalid json format")}return null}function b(t){try{return t?JSON.parse(t):null}catch(e){i("invalid json string")}return null}function j(){var t=Ut.loginTime||Ut.initTime;return{loginTime:t,onlineTime:St.parseInt(Date.now()/1e3)-t||1,extendMap:{from:Ut.from,engine:e()||"",app:Ut.app}}}function v(t,e){var n={headerInfo:oe,onlineInfo:j(),errorInfoList:Pt.concat(),eventInfoList:ie.concat()};return t&&(n.paymentInfo=t),e&&(n.userInfo=e),n}function T(){ie.length=0,Pt.length=0}function E(){Ye.setItem(At.LOGOUT_TIME,St.parseInt(Date.now()/1e3)),(Pt.length||ie.length)&&Ye.setItem(At.QUIT_SNAPSHOT,St.jsonStringify(v()))}function I(){var t=Ye.getItem(At.QUIT_SNAPSHOT);return t&&St.jsonParse(t)}function O(t){ce>=_t.MAX_ERROR_COUNT||(Pt.push(t),ce+=1)}function y(t){ie.push(t)}function S(t,e){if(!t)return void St.tryThrow("Missing eventId");var n=function(t){return t.replace(/%/g,"_")};arguments.length>2&&(e=arguments[2]);var r={};if(St.isObject(e))for(var o in e)r[n(o)]="number"==typeof e[o]?e[o]:encodeURIComponent(e[o]);var i={eventId:n(t),eventMap:r};return yt.addEvent(i),i}function _(){return oe.uid||""}function A(t,e){var n=this;this.duration=e,this.status="running",this.timer=ze(function(){return n.run()},this.duration),this.run=function(){"cancelled"!==n.status&&(Qe(n.timer),St.attempt(t),n.timer=ze(function(){return n.run()},n.duration))},this.stop=function(){n.status="stopped",Qe(n.timer)},this.reset=function(t){"cancelled"!==n.status&&(n.stop(),t&&(n.duration=t),n.run())},this.cancel=function(){this.status="cancelled",Qe(this.timer)}}function C(t){Ke&&(Ke.stop(),ze(function(){Ke.reset(t)},t),t&&(Ut.interval=t))}function L(t,e){Ke=new A(t,e)}function N(){return Ke}function w(){Ke&&(Ke.cancel(),Ke=null)}function D(t){var e=Vt.egret,n=new e.URLLoader,r=Date.now();n.addEventListener(e.Event.COMPLETE,function(e){var n=Date.now()-r,o=e.target,i="success"===o.data;St.attempt(i?t.success:t.error,o,[o,n,n>=t.timeout]),St.attempt(t.complete,o,[o,n])});var o=new e.URLRequest(t.url);o.method=t.method||e.URLRequestMethod.POST,o.data=St.jsonStringify(t.data),n.load(o)}function R(){if(Bt&&r(Bt.createElement)){var t=Bt.createElement("div");if(!t)return!1;if(r(t.querySelector)){t.innerHTML="<i></i>";var e=t.querySelector("i");return!!e&&"I"===e.tagName}if(r(t.getElementsByTagName)){var n=t.getElementsByTagName("i");return!!n&&1===n.length}}return!1}function x(){return Vt.cc.loader.getXMLHttpRequest()}function P(t){var e=rn();on&&(e.timeout=t.timeout),e.open(t.method||"POST",t.url,!0),cn(e,"text/plain; charset=UTF-8");var n=Date.now();e.onreadystatechange=function(){if(4===this.readyState){var e=this.status>=200&&this.status<300,r=Date.now()-n;St.attempt(e?t.success:t.error,this,[this,r]),St.attempt(t.complete,this,[this,r]),this.onreadystatechange=null,this.ontimeout=null}},on&&(e.ontimeout=function(){var e=Date.now()-n;St.attempt(t.error,this,[this,e,!0]),St.attempt(t.complete,this,[this,e]),this.onreadystatechange=null,this.ontimeout=null}),e.send(St.jsonStringify(t.data))}function U(e,n){var r=Date.now();if(!n){if(r-fn<_t.ASAP_TIMEOUT)return void St.tryThrow("Request dropped: rate limit");fn=r}gn+=1,t.report=e.data,an({url:e.url,data:e.data,success:function(t,n){St.attempt(e.success,t,[t,n])},error:function(t,n,r){We+=1,St.attempt(e.error,t,[t,n,r])},complete:function(t,n){if(St.attempt(e.complete,t,[t,n]),t.getAllResponseHeaders&&t.getResponseHeader){var r=t.getAllResponseHeaders(),o="X-Rate-Limit";if(-1!==r.indexOf(o)){var i=St.parseInt(t.getResponseHeader(o));i>1&&Ct.reset(1e3*i)}}}})}function M(t){if(!t)return!1;var e=t.onlineInfo.onlineTime;return 1>e||e>_t.MAX_ONLINE_TIME?(St.tryThrow("Illegal online time"),!1):!0}function V(){return Ut.inited?void 0:(St.tryThrow("DCAgent.init needed"),!1)}function F(){return Ut.loginTime?void 0:(St.tryThrow("DCAgent.login needed"),!1)}function G(t){return t+"?__deuid="+oe.uid+"&__deappid="+oe.appId}function k(t){return t+"?type=h520&appId="+oe.appId+"&uid="+oe.uid+"&mac="+(oe.mac||"")+"&imei="+(oe.imei||"")+"&idfa="+(oe.idfa||"")}function H(t,e,n){if(t||!St.hiddenProperty||!Bt[St.hiddenProperty]){var r={url:wt.appendOnline(wt.API_PATH)};if(gn&&gn%Ut.oss===0&&yt.addEvent({eventId:At.REQ_KEY,eventMap:{succ:gn-We,fail:We,total:gn}}),r.data=yt.collect(e,n),Nt.isParamsValid(r.data)){yt.clear();var o=r.data.errorInfoList,i=r.data.eventInfoList;(i.length||o.length)&&(r.error=function(){o.forEach(function(t){yt.addError(t)}),i.forEach(function(t){yt.addEvent(t)})}),U(r,t)}}}function X(){var t=arguments.length<=0||void 0===arguments[0]?_t.ASAP_TIMEOUT:arguments[0];Qe(un);var e=Ct.get();e.stop(),un=ze(function(){e.run()},t)}function B(t){if(!t)return void St.tryThrow("Missing accountID");if(oe.accountId===t)return void(Ut.loginTime=Ut.loginTime||St.parseInt(Date.now()/1e3));var e=Ct.get();Dt.setPollingDebounce(e.duration),H(!0),Ut.loginTime=St.parseInt(Date.now()/1e3);var n=At.ACCOUNT_RELATED_SETTINGS+","+At.ACCOUNT_ROLE_SETTINGS;n.split(",").forEach(function(t){return oe[t]=""}),oe.age=_t.DEFAULT_AGE,oe.gender=_t.DEFAULT_GENDER,oe.roleLevel=_t.DEFAULT_ROLE_LEVEL,oe.accountId=t,H(!0)}function q(t,e,n,r){var o=arguments;At.ACCOUNT_ROLE_SETTINGS.split(",").forEach(function(t,e){return oe[t]=o[e]||""}),oe.roleLevel=St.parseInt(r)||1}function K(t,e,n,r){q(t,e,n,r),S("DE_EVENT_CREATE_ROLE",{roleId:String(t),roleRace:String(e),roleClass:String(n)})}function Y(t){oe.gender=2===t?2:1}function z(t){oe.gameServer=String(t)}function Q(t){t=St.parseInt(t),oe.age=t>0&&128>t?t:0}function W(t){oe.accountType=String(t)}function J(t,e){return e=St.parseInt(e),0>e?(St.tryThrow("Argument error"),!1):void S(At.EVT_TASK,{actionType:"taskUnfinish",taskId:String(t),elapsed:e})}function $(t,e){return e=St.parseInt(e),0>e?(St.tryThrow("Argument error"),!1):void S(At.EVT_TASK,{actionType:"taskFinish",taskId:String(t),elapsed:e})}function Z(t){if(!t||!t.hasOwnProperty("amount"))return void St.tryThrow("Missing amount");var e={currencyAmount:St.max(parseFloat(t.amount,10)||0),currencyType:t.currencyType||"CNY",payType:String(t.payType||""),iapid:String(t.iapid||""),payTime:St.parseInt(Date.now()/1e3),extendMap:{orderId:String(t.orderId||"")}};return H(!0,e),e}function tt(t,e){return e=St.parseInt(e),0>e?(St.tryThrow("Argument error"),!1):void S(At.EVT_MISSION,{actionType:"guankaUnfinish",guankaId:String(t),duration:e})}function et(t,e){return e=St.parseInt(e),0>e?(St.tryThrow("Argument error"),!1):void S(At.EVT_MISSION,{actionType:"guankaFinish",guankaId:String(t),duration:e})}function nt(t,e,n){return t=St.parseInt(t),e=St.parseInt(e),n=St.parseInt(n),0>t||0>e||t>e||0>n?(St.tryThrow("Argument error"),!1):(oe.roleLevel=e,void S(At.EVT_LEVEL,{startLevel:t,endLevel:e,duration:n}))}function rt(t,e,n,r){return e=St.parseInt(e),0>e?(St.tryThrow("Argument error"),!1):void S(At.EVT_ITEM,{actionType:"itemUse",itemId:String(t),itemNum:e,reason:String(r),missonID:String(n)})}function ot(t,e,n,r){return e=St.parseInt(e),0>e?(St.tryThrow("Argument error"),!1):void S(At.EVT_ITEM,{actionType:"itemGet",itemId:String(t),itemNum:e,reason:String(r),missonID:String(n)})}function it(t,e,n,r,o){return e=St.parseInt(e),r=St.parseInt(r),0>e||0>r?(St.tryThrow("Argument error"),!1):void S(At.EVT_ITEM,{actionType:"itemBuy",itemId:String(t),itemNum:e,coinType:String(n),coinNum:r,missonID:String(o)})}function ct(t,e,n,r){return e=St.parseInt(e),t=St.parseInt(t),0>e||0>t?(St.tryThrow("Argument error"),!1):void S(At.EVT_COIN,{actionType:"coinUse",coinType:String(n),balanceNum:e,coinNum:t,reason:String(r)})}function at(t,e,n,r){return e=St.parseInt(e),t=St.parseInt(t),0>e||0>t||t>e?(St.tryThrow("Argument error"),!1):void S(At.EVT_COIN,{actionType:"coinGet",coinType:String(n),balanceNum:e,coinNum:t,reason:String(r)})}function ut(){return Ut.inited}function st(){for(var t=["pagehide","beforeunload","unload"],e=0;e<t.length;e+=1)if("on"+t[e]in Vt)return t[e]}function gt(t){if(Vt.addEventListener){var e=st();e&&Vt.addEventListener(e,t)}}function ft(t){Ut.storage&&(gt(yt.saveToStorage),t||U({url:wt.appendOnline(wt.API_PATH),data:yt.loadFromStorage()},!0))}function lt(){Vt.addEventListener&&Vt.addEventListener("error",function(t){St.attempt(function(){var e={},n=["colno","filename","lineno","message"];n.forEach(function(n){return e[n]=t[n]||"1"});var r=t.error||{};if(e.stack=encodeURIComponent(r.stack||r.stacktrace||""),e.type=r.name||"Error",e.timestamp=parseInt(t.timeStamp/1e3),St.isFunction(Ut.getErrorScene)){var o=St.attempt(Ut.getErrorScene,r,[t]);if(o){if(St.isObject(o)){var i="";for(var c in o)i+="	"+c+"="+o[c]+"\n";o=i}else o=String(o);e.stack+="\n\nError scene:\n"+encodeURIComponent(o)}}yt.addError(e)})},!1)}function pt(t){return Lt.isStandardBrowser||At.CLIENT_KEY===t?t:oe.appId+"."+t}function dt(t,e){t=pt(t),Ye.setItem(t,e),yn.set(t,e,3650)}function ht(t){return t=pt(t),Ye.getItem(t)||yn.get(t)}function mt(){var t=Date.now().toString(36).toUpperCase(),e=xt.engine;return e.egret?At.EGRET_PREFIX+t:e.layabox?At.LAYA_PREFIX+t:e.cocos?At.COCOS_PREFIX+t:At.UNKNOW_ENGINE+t}function bt(t){var e,n;e=Array.prototype.forEach,n=Array.prototype.map,this.each=function(t,n,r){if(null!==t)if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===+t.length){for(var o=0,i=t.length;i>o;o++)if(n.call(r,t[o],o,t)==={})return}else for(var c in t)if(t.hasOwnProperty(c)&&n.call(r,t[c],c,t)==={})return},this.map=function(t,e,r){var o=[];return null==t?o:n&&t.map===n?t.map(e,r):(this.each(t,function(t,n,i){o[o.length]=e.call(r,t,n,i)}),o)},"object"==typeof t?(this.hasher=t.hasher,this.screen_resolution=t.screen_resolution,this.screen_orientation=t.screen_orientation,this.canvas=t.canvas,this.ie_activex=t.ie_activex):"function"==typeof t&&(this.hasher=t)}function jt(){var t;try{if(Lt.isStandardBrowser)t=new An({canvas:!0,screen_resolution:!0,ie_activex:!0}).get().toString();else if(xt.engine.layabox){var e=Vt.layabox.getDeviceInfo()||{};t=e.mac||e.idfa,t=t&&t.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(n){t=null}return t=St.padding(t,At.PADDING_STRING,_t.UID_MIN_LENGTH),t||St.uuid(mt())}function vt(t){if(oe.uid){var e=St.padding(oe.uid,At.PADDING_STRING,_t.UID_MIN_LENGTH);t!==e&&(oe.uid=e,t=e,Ye.setItem(At.CREATE_TIME,St.parseInt(Date.now()/1e3)))}var n=t||jt();return Rt.setItem(At.CLIENT_KEY,n),n}function Tt(t){var e=Rt.getItem(At.CLIENT_KEY),n=e?0:1,r=vt(e);oe.uid=r,oe.accountId=r,t.errorReport&&lt(),Ut.initTime=St.parseInt(Date.now()/1e3);var o=Ye.getItem(At.CREATE_TIME);o||(o=Ut.initTime,Ye.setItem(At.CREATE_TIME,o)),Ut.createTime=St.parseInt(o);var i=Lt.isStandardBrowser?Ze.href:"!";yt.addEvent({eventId:At.EVT_PV,eventMap:{page:encodeURI(i.split("?")[0])}});var c=n?{actTime:o,regTime:o}:null;H(!0,null,c),ft(n);var a=St.isDebug?_t.MIN_ONLINE_INTERVAL_DEBUG:_t.MIN_ONLINE_INTERVAL,u=1e3*Math.max(a,parseFloat(t.interval||a));Ct.set(H,u),Ut.interval=u,Ut.inited=!0}function Et(t){return Ut.storage=St.isLocalStorageSupported(Ye),t.uid||Ut.storage?Ut.inited?"Initialization ignored":t&&t.appId?(t.appId=t.appId.toUpperCase(),Ut.oss="number"==typeof t.oss?t.oss:0,Ut.getErrorScene=t.getErrorScene,Ut.app=t.appName||"",Ut.from=t.from||St.getHostName(Bt.referrer),void At.USER_INIT_BASE_SETTINGS.split(",").forEach(function(e){t.hasOwnProperty(e)&&(oe[e]=t[e])})):"Missing appId":Lt.hasStorage?"Storage quota error":"Storage not support"}function It(t){var e=Et(t);return e?St.tryThrow(e):(Tt(t),void(St.isDebug||U({url:wt.appendEcho(Lt.protocol+"//"+At.HOST+"/echo"),method:"GET"},!0)))}var Ot,yt={get getOnlineInfo(){return j},get collect(){return v},get clear(){return T},get saveToStorage(){return E},get loadFromStorage(){return I},get addError(){return O},get addEvent(){return y}},St={get isDebug(){return kt},get noop(){return n},get isFunction(){return r},get isObject(){return o},get log(){return i},get tryThrow(){return Ht},get uuid(){return c},get extend(){return a},get attempt(){return Xt},get isLocalStorageSupported(){return u},get repeat(){return s},get padding(){return g},get aspect(){return f},get getHostName(){return l},get hiddenProperty(){return qt},get slice(){return p},get parseInt(){return d},get max(){return h},get jsonStringify(){return m},get jsonParse(){return b}},_t={get REQUEST_TIME_OUT(){return Kt},get MAX_ONLINE_TIME(){return Yt},get MIN_ONLINE_INTERVAL(){return zt},get MIN_ONLINE_INTERVAL_DEBUG(){return Qt},get UID_MIN_LENGTH(){return Wt},get ASAP_TIMEOUT(){return Jt},get MAX_ERROR_COUNT(){return $t},get DEFAULT_AGE(){return Zt},get DEFAULT_GENDER(){return te},get DEFAULT_ROLE_LEVEL(){return ee},get DEFAULT_NET_TYPE(){return ne},get DEFAULT_PLATFORM(){return re}},At={get HOST(){return Ee},get CREATE_TIME(){return Ie},get EGRET_PREFIX(){return Oe},get LAYA_PREFIX(){return ye},get COCOS_PREFIX(){return Se},get UNKNOW_ENGINE(){return _e},get PARENT_KEY(){return Ae},get EVENTS_KEY(){return Ce},get ERRORS_KEY(){return Le},get CLIENT_KEY(){return Ne},get QUIT_SNAPSHOT(){return we},get LOGOUT_TIME(){return De},get API_PATH(){return Re},get PADDING_STRING(){return xe},get REQ_KEY(){return Pe},get USER_INIT_BASE_SETTINGS(){return Ue},get ACCOUNT_RELATED_SETTINGS(){return Me},get ACCOUNT_ROLE_SETTINGS(){return Ve},get EVT_COIN(){return Fe},get EVT_ITEM(){return Ge},get EVT_LEVEL(){return ke},get EVT_MISSION(){return He},get EVT_TASK(){return Xe},get EVT_PV(){return Be}},Ct={get reset(){return C},get set(){return L},get get(){return N},get destroy(){return w}},Lt={get hasStorage(){return qe},get isStandardBrowser(){return Je},get hasCookie(){return $e},get protocol(){return tn},get useXDR(){return en},get device(){return je}},Nt={get isParamsValid(){return M},get shouldBeInited(){return V},get shouldBeLoggedIn(){return F}},wt={get API_PATH(){return ln},get appendOnline(){return G},get appendEcho(){return k}},Dt={get setPollingDebounce(){return X}},Rt={get setItem(){return dt},get getItem(){return ht}},xt={get engine(){return fe},get"default"(){return e}},Pt=[],Ut={inited:!1},Mt=(1,eval)("this"),Vt=Mt||{},Ft=0,Gt=Object.prototype.toString,kt=Vt.DCAGENT_DEBUG_OPEN,Ht=kt?function(t){throw new Error(t)}:function(t){i(t)},Xt=kt?function(t,e,n){return r(t)?t.apply(e,n):void 0}:function(t,e,n){if(r(t))try{return t.apply(e,n)}catch(o){i("exec error for function:\n "+t.toString())}},Bt=Mt.document||{},qt="hidden"in Bt?"hidden":"webkitHidden"in Bt?"webkitHidden":"mozHidden"in Bt?"mozHidden":"msHidden"in Bt?"msHidden":null;t.version=24;var Kt=3e4,Yt=172800,zt=40,Qt=15,Wt=32,Jt=5e3,$t=100,Zt=0,te=0,ee=0,ne=3,re=0,oe={accountId:"",accountType:"",age:_t.DEFAULT_AGE,appId:"",appVersion:"",brand:"",channel:"",customDeviceId:"",gameServer:"",gender:_t.DEFAULT_GENDER,idfa:"",imei:"",lonLat:"",mac:"",netType:_t.DEFAULT_NET_TYPE,operator:"",osVersion:"",platform:_t.DEFAULT_PLATFORM,resolution:"",roleClass:"",roleId:"",roleLevel:_t.DEFAULT_ROLE_LEVEL,roleRace:"",simCardOp:"",uid:"",ver:t.version},ie=[],ce=0,ae=_t.DEFAULT_PLATFORM,ue=Vt.screen||{},se=ue.width&&ue.width+"*"+ue.height,ge="0*0";se||(se=ge);var fe={isEgret:!!Vt.egret,isLayabox:!!Vt.layabox,isCocos:!!Vt.cc&&!!Vt.cc.game},le="",pe="",de=Vt.navigator&&Vt.navigator.userAgent||"";if(!de){var he=["ios","android"];if(fe.layabox){var me=Vt.layabox.getDeviceInfo()||{};se=me.resolution||ge,pe=me.phonemodel,ae=he.indexOf(me.os.toLowerCase()),le=(me.os+" "+me.osversion).toLowerCase()}else if(fe.cocos){var be=Vt.cc.view.getViewPortRect()||{};se=be.width+"*"+be.height,ae=he.indexOf(Vt.cc.sys.os.toLowerCase())}-1===[0,1,2,3].indexOf(ae)&&(ae=_t.DEFAULT_PLATFORM)}var je={resolution:se,brand:pe,osVersion:le,platform:ae};for(var ve in je)oe[ve]=oe[ve]||je[ve];var Te,Ee="rd.gdatacube.net",Ie="dcagent_create_time",Oe="EGRET",ye="LAYA",Se="COCOS",_e="UE",Ae="dcagent_parent_id",Ce="dcagent_client_events",Le="dcagent_client_errors",Ne="dcagent_client_id",we="dcagent_snapshot",De="dc_p_lo",Re="/dc/hh5/sync",xe="0A",Pe="DE_EVENT_OSS",Ue="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",Me="accountId,accountType,age,gender,gameServer",Ve="roleId,roleRace,roleClass,roleLevel",Fe="DE_EVENT_COIN_ACTION",Ge="DE_EVENT_ITEM_ACTION",ke="DE_EVENT_LEVELUP",He="DE_EVENT_GUANKA_ACTION",Xe="DE_EVENT_TASK_ACTION",Be="DE_EVENT_PV",qe=!!Vt.localStorage||fe.isEgret||fe.isCocos||fe.isLayabox;Te=fe.isEgret?Vt.egret.localStorage:fe.isCocos?Vt.cc.sys.localStorage:qe?Vt.localStorage:{getItem:n,setItem:n,removeItem:n};var Ke,Ye=Te,ze=Vt.setTimeout,Qe=Vt.clearTimeout;fe.isEgret&&(ze=function(t,e){Vt.egret.setTimeout(t,Vt,e)},Qe=function(t){Vt.egret.clearTimeout(t)});var We=0,Je=R(),$e=Je&&"cookie"in Bt,Ze=Mt.location||{},tn="https:"===Ze.protocol?"https:":"http:",en=!!Vt.XDomainRequest,nn=Lt.useXDR?function(){return new Vt.XDomainRequest}:function(){return new Vt.XMLHttpRequest},rn=fe.isCocos?x:nn,on=function(){try{var t=rn();return t.timeout=1,!0}catch(e){return!1}}(),cn=Lt.useXDR?function(t,e){t.contentType=e}:function(t,e){t.setRequestHeader("Content-Type",e)},an=function(){return Vt.XMLHttpRequest||fe.isCocos?P:fe.isEgret?D:(St.log("XMLHttpRequest not found"),St.noop)}();t.report;var un,sn,gn=0,fn=Date.now()-_t.ASAP_TIMEOUT,ln=Lt.protocol+"//"+At.HOST+At.API_PATH,pn={login:B,getUid:_,onEvent:S},dn={onCoinGet:at,onCoinUse:ct,onItemBuy:it,onItemProduce:ot,onItemUse:rt,onLevelUp:nt,onMissionFinished:et,onMissionUnfinished:tt,onPayment:Z,onTaskFinished:$,onTaskUnfinished:J,setAccountType:W,setAge:Q,setGameServer:z,setGender:Y,setRoleInfo:q,createRole:K},hn=[Nt.shouldBeInited],mn=[Nt.shouldBeLoggedIn],bn=[Dt.setPollingDebounce];for(sn in pn)t[sn]=St.aspect(pn[sn],hn,"onEvent"===sn&&bn);for(sn in dn)t[sn]=St.aspect(dn[sn],mn,"onPayment"!==sn&&bn);var jn=Vt.DCAgentObject;if(jn){var vn=Vt[jn];if(St.isFunction(vn)){var Tn=vn.cache;Tn.length&&(Tn.forEach(function(e){St.attempt(t[e[0]],t,St.slice(e,1))}),Tn.length=0)}}var En={get isNew(){var t=Ut.loginTime||Ut.initTime;return Ut.createTime===t},get initTime(){return Ut.initTime},get createTime(){return Ut.createTime},get loginTime(){return Ut.loginTime},get lastLogoutTime(){return parseInt(Ye.getItem(At.LOGOUT_TIME))},get reportCount(){return gn},get reportFailedCount(){return We}},In={get:function(t){var e="(^|)\\s*"+t+"=([^\\s]*)",n=Bt.cookie.match(new RegExp(e));return n&&n.length>=3?decodeURIComponent(n[2]):null},set:function(t,e,n,r,o,i){var c;n&&(c=new Date,c.setTime(c.getTime()+864e5*n));var a=n?" expires="+c.toGMTString():"",u=" path="+(o||"/"),s=r?" domain="+r:"",g=i?" secure":"";Bt.cookie=t+"="+encodeURIComponent(e)+a+u+s+g},remove:function(t,e,n){In.set(t,"",-1,e,n)}},On=Lt.hasCookie?In:{get:St.noop,set:St.noop},yn=On,Sn=Vt.navigator;bt.prototype.isIE=function(){return"Microsoft Internet Explorer"===Sn.appName?!0:"Netscape"===Sn.appName&&/Trident/.test(Sn.userAgent)?!0:!1},bt.prototype.getRegularPluginsString=function(){return this.map(Sn.plugins,function(t){var e=this.map(t,function(t){return[t.type,t.suffixes].join("~")}).join(",");return[t.name,t.description,e].join("::")},this).join(";")};var _n=Vt.screen;bt.prototype.get=function(){var t=[];if(t.push(Sn.userAgent),t.push(Sn.language),t.push(_n.colorDepth),this.screen_resolution){var e=this.getScreenResolution();"undefined"!=typeof e&&t.push(e.join("x"))}return t.push((new Date).getTimezoneOffset()),t.push(this.hasSessionStorage()),t.push(this.hasLocalStorage()),t.push(!!Vt.indexedDB),Bt.body?t.push(typeof Bt.body.addBehavior):t.push("undefined"),t.push(typeof Vt.openDatabase),t.push(Sn.cpuClass),t.push(Sn.platform),t.push(Sn.doNotTrack),t.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&t.push(this.getCanvasFingerprint()),this.hasher?this.hasher(t.join("###"),31):this.murmurhash3_32_gc(t.join("###"),31)},bt.prototype.murmurhash3_32_gc=function(t,e){var n,r,o,i,c,a,u,s;for(n=3&t.length,r=t.length-n,o=e,c=3432918353,a=461845907,s=0;r>s;)u=255&t.charCodeAt(s)|(255&t.charCodeAt(++s))<<8|(255&t.charCodeAt(++s))<<16|(255&t.charCodeAt(++s))<<24,++s,u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=(65535&i)+27492+(((i>>>16)+58964&65535)<<16);switch(u=0,n){case 3:u^=(255&t.charCodeAt(s+2))<<16;break;case 2:u^=(255&t.charCodeAt(s+1))<<8;break;case 1:u^=255&t.charCodeAt(s),u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u}return o^=t.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0},bt.prototype.hasLocalStorage=function(){try{return!!Vt.localStorage}catch(t){return!0}},bt.prototype.hasSessionStorage=function(){try{return!!Vt.sessionStorage}catch(t){return!0}},bt.prototype.isCanvasSupported=function(){var t=Bt.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},bt.prototype.getPluginsString=function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},bt.prototype.getIEPluginsString=function(){if(Vt.ActiveXObject){var t=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(t,function(t){try{return new Vt.ActiveXObject(t),t}catch(e){return null}}).join(";")}return""},bt.prototype.getScreenResolution=function(){var t;return t=this.screen_orientation?_n.height>_n.width?[_n.height,_n.width]:[_n.width,_n.height]:[_n.height,_n.width]},bt.prototype.getCanvasFingerprint=function(){var t=Bt.createElement("canvas"),e=t.getContext("2d"),n="http://www.dataeye.com/";return e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(n,2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(n,4,17),t.toDataURL()};var An=bt;t.init=It,t.player=En,t.isReady=ut,t.destroy=w,t.state=Ut});