!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.DCAgent={})}(this,function(e){"use strict";function t(){if(Te)return Te;if(Me+=1,!(Me>4)){var e={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"};for(var t in e){var n=e[t];if(n.indexOf(".")>-1){var r=n.split("."),o=Ue[r[0]];if(o&&o[r[1]])return Te=t,t}else if(Ue[n])return Te=t,t}}}function n(){}function r(e){return"function"==typeof e}function o(e){return e&&"[object Object]"===Ve.call(e)}function i(e){console.log("---- DCAgent log start ----\n"+e+"\n---- DCAgent log end   ----")}function c(e){var t,n,r;return t=Date.now(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r=n.replace(/[xy]/g,function(e){var n;return n=(t+16*Math.random())%16|0,t=Math.floor(t/16),"x"===e?n.toString(16):(7&n|8).toString(16)}),(e||"")+r.replace(/-/g,"").toUpperCase()}function a(e){var t,n;for(t in e)n=e[t],e[t]=n;var r=arguments.length>=2?[].slice.call(arguments,1):[];return r.forEach(function(r){var o;o=[];for(t in r)n=r[t],o.push(e[t]=n);return o}),e}function u(e){var t=".";try{return e.setItem(t,t),e.removeItem(t),!0}catch(n){return!1}}function s(e){for(var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n="",r=0;t>r;r+=1)n+=e;return n}function f(e,t,n){return e?e&&e.length>=n?e:e+s(t,Math.ceil(n-e.length)/t.length):e}function g(e,t,n){return function(){Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);var r,o;for(r=0;r<t.length;r+=1)if(o=t[r],ke(o,this,arguments)===!1)return;var i=ke(e,this,arguments);if(i===!1)return!1;for(r=0;r<n.length;r+=1)o=n[r],ke(o,this,arguments);return i}}function l(e){if(!e)return"";var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return t?t[3]:""}function p(e,t,n){return[].slice.call(e,t,n)}function d(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return e>=1e21&&(e=9527e16),Ue.parseInt(e,n)||t}function h(e){return Math.min(99e19,e)}function m(e){try{return e?JSON.stringify(e):null}catch(t){i("invalid json format")}return null}function b(e){try{return e?JSON.parse(e):null}catch(t){i("invalid json string")}return null}function j(){var e=we.loginTime||we.initTime;return{loginTime:e,onlineTime:Oe.parseInt(Date.now()/1e3)-e||1,extendMap:{from:we.from,engine:t()||"",app:we.app}}}function v(e,t){var n={headerInfo:nt,onlineInfo:j(),errorInfoList:De.concat(),eventInfoList:rt.concat()};return e&&(n.paymentInfo=e),t&&(n.userInfo=t),n}function E(){rt.length=0,De.length=0}function T(){qt.setItem(_e.LOGOUT_TIME,Oe.parseInt(Date.now()/1e3)),(De.length||rt.length)&&qt.setItem(_e.QUIT_SNAPSHOT,Oe.jsonStringify(v()))}function I(){return Oe.jsonParse(qt.getItem(_e.QUIT_SNAPSHOT))}function O(e){ot>=ye.MAX_ERROR_COUNT||(De.push(e),ot+=1)}function y(e){rt.push(e)}function _(e,t){if(!e)return void Oe.tryThrow("Missing eventId");var n=function(e){return e.replace(/%/g,"_")};arguments.length>2&&(t=arguments[2]);var r={};if(Oe.isObject(t))for(var o in t)r[n(o)]="number"==typeof t[o]?t[o]:encodeURIComponent(t[o]);var i={eventId:n(e),eventMap:r};return Ie.addEvent(i),i}function S(){return nt.uid||""}function A(e,t){var n=this;this.duration=t,this.status="running",this.timer=Kt(function(){return n.run()},this.duration),this.run=function(){Yt(n.timer),Oe.attempt(e),n.timer=Kt(function(){return n.run()},n.duration)},this.stop=function(){n.status="stopped",Yt(n.timer)},this.reset=function(e){n.stop(),e&&(n.duration=e),n.run()}}function C(e){Bt&&(Bt.stop(),Kt(function(){Bt.reset(e)},e))}function L(e,t){Bt=new A(e,t)}function N(){return Bt}function R(e){var t=Ue.egret,n=new t.URLLoader,r=Date.now();n.addEventListener(t.Event.COMPLETE,function(t){var n=Date.now()-r,o=t.target,i="success"===o.data;Oe.attempt(i?e.success:e.error,o,[o,n,n>=e.timeout]),Oe.attempt(e.complete,o,[o,n])});var o=new t.URLRequest(e.url);o.method=e.method||t.URLRequestMethod.POST,o.data=Oe.jsonStringify(e.data),n.load(o)}function x(){if(He&&r(He.createElement)){var e=He.createElement("div");if(!e)return!1;if(r(e.querySelector)){e.innerHTML="<i></i>";var t=e.querySelector("i");return!!t&&"I"===t.tagName}if(r(e.getElementsByTagName)){var n=e.getElementsByTagName("i");return!!n&&1===n.length}}return!1}function D(){return Ue.cc.loader.getXMLHttpRequest()}function w(e){var t=rn();on&&(t.timeout=e.timeout),t.open(e.method||"POST",e.url,!0),cn(t,"text/plain; charset=UTF-8");var n=Date.now();t.onreadystatechange=function(){if(4===this.readyState){var t=this.status>=200&&this.status<300,r=Date.now()-n;Oe.attempt(t?e.success:e.error,this,[this,r]),Oe.attempt(e.complete,this,[this,r]),this.onreadystatechange=null,this.ontimeout=null}},on&&(t.ontimeout=function(){var t=Date.now()-n;Oe.attempt(e.error,this,[this,t,!0]),Oe.attempt(e.complete,this,[this,t]),this.onreadystatechange=null,this.ontimeout=null}),t.send(Oe.jsonStringify(e.data))}function P(e,t){var n=Date.now();if(!t){if(n-sn<ye.ASAP_TIMEOUT)return void Oe.tryThrow("Request dropped: rate limit");sn=n}un+=1,an({url:e.url,data:e.data,success:function(t,n){Oe.attempt(e.success,t,[t,n])},error:function(t,n,r){Wt+=1,Oe.attempt(e.error,t,[t,n,r])},complete:function(t,n){if(Oe.attempt(e.complete,t,[t,n]),t.getAllResponseHeaders&&t.getResponseHeader){var r=t.getAllResponseHeaders(),o="X-Rate-Limit";if(-1!==r.indexOf(o)){var i=Oe.parseInt(t.getResponseHeader(o));i>1&&Se.reset(1e3*i)}}}})}function U(e){if(!e)return!1;var t=e.onlineInfo.onlineTime;return 1>t||t>ye.MAX_ONLINE_TIME?(Oe.tryThrow("Illegal online time"),!1):!0}function M(){return we.inited?void 0:(Oe.tryThrow("DCAgent.init needed"),!1)}function V(){return we.loginTime?void 0:(Oe.tryThrow("DCAgent.login needed"),!1)}function G(e){return e+"?__deuid="+nt.uid+"&__deappid="+nt.appId}function F(e){return e+"?type=h520&appId="+nt.appId+"&uid="+nt.uid+"&mac="+(nt.mac||"")+"&imei="+(nt.imei||"")+"&idfa="+(nt.idfa||"")}function k(e,t,n){if(e||!Oe.hiddenProperty||!He[Oe.hiddenProperty]){var r={url:Le.appendOnline(fn)};if(un&&un%we.oss===0&&Ie.addEvent({eventId:_e.REQ_KEY,eventMap:{succ:un-Wt,fail:Wt,total:un}}),r.data=Ie.collect(t,n),Ce.isParamsValid(r.data)){Ie.clear();var o=r.data.errorInfoList,i=r.data.eventInfoList;(i.length||o.length)&&(r.error=function(){o.forEach(function(e){Ie.addError(e)}),i.forEach(function(e){Ie.addEvent(e)})}),P(r,e)}}}function H(){var e=arguments.length<=0||void 0===arguments[0]?ye.ASAP_TIMEOUT:arguments[0];Yt(zt);var t=Se.get();t.stop(),zt=Kt(function(){t.run()},e)}function X(e){if(!e)return void Oe.tryThrow("Missing accountID");if(nt.accountId===e)return void(we.loginTime=we.loginTime||Oe.parseInt(Date.now()/1e3));var t=Se.get();Ne.setPollingDebounce(t.duration),k(!0),we.loginTime=Oe.parseInt(Date.now()/1e3);var n=_e.ACCOUNT_RELATED_SETTINGS+","+_e.ACCOUNT_ROLE_SETTINGS;n.split(",").forEach(function(e){return nt[e]=""}),nt.age=ye.DEFAULT_AGE,nt.gender=ye.DEFAULT_GENDER,nt.roleLevel=ye.DEFAULT_ROLE_LEVEL,nt.accountId=e,k(!0)}function B(e,t,n,r){var o=arguments;_e.ACCOUNT_ROLE_SETTINGS.split(",").forEach(function(e,t){return nt[e]=o[t]||""}),nt.roleLevel=Oe.parseInt(r)||1}function q(e,t,n,r){B(e,t,n,r),_("DE_EVENT_CREATE_ROLE",{roleId:String(e),roleRace:String(t),roleClass:String(n)})}function K(e){nt.gender=2===e?2:1}function Y(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];nt.gameServer=String(e)}function z(e){e=Oe.parseInt(e),nt.age=e>0&&128>e?e:0}function Q(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];nt.accountType=String(e)}function W(e,t){_(_e.EVT_TASK,{actionType:"taskUnfinish",taskId:e,elapsed:Oe.parseInt(t)})}function J(e,t){_(_e.EVT_TASK,{actionType:"taskFinish",taskId:e,elapsed:Oe.parseInt(t)})}function $(e){if(!e||!e.hasOwnProperty("amount"))return void Oe.tryThrow("Missing amount");var t={currencyAmount:Oe.max(parseFloat(e.amount,10)||0),currencyType:e.currencyType||"CNY",payType:String(e.payType||""),iapid:String(e.iapid||""),payTime:Oe.parseInt(Date.now()/1e3),extendMap:{orderId:String(e.orderId||"")}};return k(!0,t),t}function Z(e,t){_(_e.EVT_MISSION,{actionType:"guankaUnfinish",guankaId:e,duration:Oe.parseInt(t)})}function ee(e,t){_(_e.EVT_MISSION,{actionType:"guankaFinish",guankaId:e,duration:Oe.parseInt(t)})}function te(e,t,n){t=Oe.parseInt(t),nt.roleLevel=t,_(_e.EVT_LEVEL,{startLevel:Oe.parseInt(e),endLevel:t,duration:Oe.parseInt(n)})}function ne(e,t,n,r){_(_e.EVT_ITEM,{actionType:"itemUse",itemId:e,itemNum:Oe.parseInt(t),reason:r,missonID:n})}function re(e,t,n,r){_(_e.EVT_ITEM,{actionType:"itemGet",itemId:e,itemNum:Oe.parseInt(t),missonID:n,reason:r})}function oe(e,t,n,r,o){_(_e.EVT_ITEM,{actionType:"itemBuy",itemId:e,itemNum:Oe.parseInt(t),coinType:n,coinNum:Oe.parseInt(r),missonID:o})}function ie(e,t,n,r){_(_e.EVT_COIN,{actionType:"coinUse",coinType:n,balanceNum:Oe.parseInt(t),coinNum:Oe.parseInt(e),reason:r})}function ce(e,t,n,r){_(_e.EVT_COIN,{actionType:"coinGet",coinType:n,balanceNum:Oe.parseInt(t),coinNum:Oe.parseInt(e),reason:r})}function ae(){return we.inited}function ue(){for(var e=["pagehide","beforeunload","unload"],t=0;t<e.length;t+=1)if("on"+e[t]in Ue)return e[t]}function se(e){if(Ue.addEventListener){var t=ue();t&&Ue.addEventListener(t,e)}}function fe(){Ue.addEventListener&&Ue.addEventListener("error",function(e){Oe.attempt(function(){var t={},n=["colno","filename","lineno","message"];n.forEach(function(n){return t[n]=e[n]||"1"});var r=e.error||{};if(t.stack=encodeURIComponent(r.stack||r.stacktrace||""),t.type=r.name||"Error",t.timestamp=parseInt(e.timeStamp/1e3),Oe.isFunction(we.getErrorScene)){var o=Oe.attempt(we.getErrorScene,r,[e]);if(o){if(Oe.isObject(o)){var i="";for(var c in o)i+="	"+c+"="+o[c]+"\n";o=i}else o=String(o);t.stack+="\n\nError scene:\n"+encodeURIComponent(o)}}Ie.addError(t)})},!1)}function ge(e){return Ae.isStandardBrowser||_e.CLIENT_KEY===e?e:nt.appId+"."+e}function le(e,t){e=ge(e),qt.setItem(e,t),In.set(e,t,3650)}function pe(e){return e=ge(e),qt.getItem(e)||In.get(e)}function de(){var e=Date.now().toString(36).toUpperCase(),t=xe.engine;return t.egret?_e.EGRET_PREFIX+e:t.layabox?_e.LAYA_PREFIX+e:t.cocos?_e.COCOS_PREFIX+e:_e.UNKNOW_ENGINE+e}function he(e){var t,n;t=Array.prototype.forEach,n=Array.prototype.map,this.each=function(e,n,r){if(null!==e)if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===+e.length){for(var o=0,i=e.length;i>o;o++)if(n.call(r,e[o],o,e)==={})return}else for(var c in e)if(e.hasOwnProperty(c)&&n.call(r,e[c],c,e)==={})return},this.map=function(e,t,r){var o=[];return null==e?o:n&&e.map===n?e.map(t,r):(this.each(e,function(e,n,i){o[o.length]=t.call(r,e,n,i)}),o)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)}function me(){var e;try{if(Ae.isStandardBrowser)e=new _n({canvas:!0,screen_resolution:!0,ie_activex:!0}).get().toString();else if(xe.engine.layabox){var t=Ue.layabox.getDeviceInfo()||{};e=t.mac||t.idfa,e=e&&e.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(n){e=null}return e=Oe.padding(e,_e.PADDING_STRING,ye.UID_MIN_LENGTH),e||Oe.uuid(de())}function be(e){if(nt.uid){var t=Oe.padding(nt.uid,_e.PADDING_STRING,ye.UID_MIN_LENGTH);e!==t&&(nt.uid=t,e=t,qt.setItem(_e.CREATE_TIME,Oe.parseInt(Date.now()/1e3)))}var n=e||me();return Re.setItem(_e.CLIENT_KEY,n),n}function je(e){var t=Re.getItem(_e.CLIENT_KEY),n=t?0:1,r=be(t);nt.uid=r,nt.accountId=r,e.errorReport&&fe(),we.initTime=Oe.parseInt(Date.now()/1e3);var o=qt.getItem(_e.CREATE_TIME);o||(o=we.initTime,qt.setItem(_e.CREATE_TIME,o)),we.createTime=Oe.parseInt(o);var i=Ae.isStandardBrowser?Zt.href:"!";Ie.addEvent({eventId:_e.EVT_PV,eventMap:{page:encodeURI(i.split("?")[0])}});var c=n?{actTime:o,regTime:o}:null;k(!0,null,c),se(Ie.saveToStorage);var a=Oe.isDebug?ye.MIN_ONLINE_INTERVAL_DEBUG:ye.MIN_ONLINE_INTERVAL,u=1e3*Math.max(a,parseFloat(e.interval||a));Se.set(k,u),we.inited=!0}function ve(e){return Oe.isLocalStorageSupported(qt)?we.inited?"Initialization ignored":e&&e.appId?(e.appId=e.appId.toUpperCase(),we.oss="number"==typeof e.oss?e.oss:0,we.getErrorScene=e.getErrorScene,we.app=e.appName||"",we.from=e.from||Oe.getHostName(He.referrer),void _e.USER_INIT_BASE_SETTINGS.split(",").forEach(function(t){e.hasOwnProperty(t)&&(nt[t]=e[t])})):"Missing appId":Ae.hasStorage?"Storage quota error":"Storage not support"}function Ee(e){var t=ve(e);return t?Oe.tryThrow(t):(je(e),void P({url:Le.appendEcho(Ae.protocol+"//"+_e.HOST+"/echo"),method:"GET"},!0))}var Te,Ie={get getOnlineInfo(){return j},get collect(){return v},get clear(){return E},get saveToStorage(){return T},get loadFromStorage(){return I},get addError(){return O},get addEvent(){return y}},Oe={get isDebug(){return Ge},get noop(){return n},get isFunction(){return r},get isObject(){return o},get log(){return i},get tryThrow(){return Fe},get uuid(){return c},get extend(){return a},get attempt(){return ke},get isLocalStorageSupported(){return u},get repeat(){return s},get padding(){return f},get aspect(){return g},get getHostName(){return l},get hiddenProperty(){return Xe},get slice(){return p},get parseInt(){return d},get max(){return h},get jsonStringify(){return m},get jsonParse(){return b}},ye={get REQUEST_TIME_OUT(){return Be},get MAX_ONLINE_TIME(){return qe},get MIN_ONLINE_INTERVAL(){return Ke},get MIN_ONLINE_INTERVAL_DEBUG(){return Ye},get UID_MIN_LENGTH(){return ze},get ASAP_TIMEOUT(){return Qe},get MAX_ERROR_COUNT(){return We},get DEFAULT_AGE(){return Je},get DEFAULT_GENDER(){return $e},get DEFAULT_ROLE_LEVEL(){return Ze},get DEFAULT_NET_TYPE(){return et},get DEFAULT_PLATFORM(){return tt}},_e={get HOST(){return vt},get CREATE_TIME(){return Et},get EGRET_PREFIX(){return Tt},get LAYA_PREFIX(){return It},get COCOS_PREFIX(){return Ot},get UNKNOW_ENGINE(){return yt},get PARENT_KEY(){return _t},get EVENTS_KEY(){return St},get ERRORS_KEY(){return At},get CLIENT_KEY(){return Ct},get QUIT_SNAPSHOT(){return Lt},get LOGOUT_TIME(){return Nt},get API_PATH(){return Rt},get PADDING_STRING(){return xt},get REQ_KEY(){return Dt},get USER_INIT_BASE_SETTINGS(){return wt},get ACCOUNT_RELATED_SETTINGS(){return Pt},get ACCOUNT_ROLE_SETTINGS(){return Ut},get EVT_COIN(){return Mt},get EVT_ITEM(){return Vt},get EVT_LEVEL(){return Gt},get EVT_MISSION(){return Ft},get EVT_TASK(){return kt},get EVT_PV(){return Ht}},Se={get reset(){return C},get set(){return L},get get(){return N}},Ae={get hasStorage(){return Xt},get isStandardBrowser(){return Jt},get hasCookie(){return $t},get protocol(){return en},get useXDR(){return tn},get device(){return mt}},Ce={get isParamsValid(){return U},get shouldBeInited(){return M},get shouldBeLoggedIn(){return V}},Le={get appendOnline(){return G},get appendEcho(){return F}},Ne={get setPollingDebounce(){return H}},Re={get setItem(){return le},get getItem(){return pe}},xe={get engine(){return st},get"default"(){return t}},De=[],we={inited:!1},Pe=(1,eval)("this"),Ue=Pe||{},Me=0,Ve=Object.prototype.toString,Ge=Ue.DCAGENT_DEBUG_OPEN,Fe=Ge?function(e){throw new Error(e)}:function(e){i(e)},ke=Ge?function(e,t,n){return r(e)?e.apply(t,n):void 0}:function(e,t,n){if(r(e))try{return e.apply(t,n)}catch(o){i("exec error for function:\n "+e.toString())}},He=Pe.document||{},Xe="hidden"in He?"hidden":"webkitHidden"in He?"webkitHidden":"mozHidden"in He?"mozHidden":"msHidden"in He?"msHidden":null;e.version=24;var Be=3e4,qe=172800,Ke=40,Ye=15,ze=32,Qe=5e3,We=100,Je=0,$e=0,Ze=0,et=3,tt=0,nt={accountId:"",accountType:"",age:ye.DEFAULT_AGE,appId:"",appVersion:"",brand:"",channel:"",customDeviceId:"",gameServer:"",gender:ye.DEFAULT_GENDER,idfa:"",imei:"",lonLat:"",mac:"",netType:ye.DEFAULT_NET_TYPE,operator:"",osVersion:"",platform:ye.DEFAULT_PLATFORM,resolution:"",roleClass:"",roleId:"",roleLevel:ye.DEFAULT_ROLE_LEVEL,roleRace:"",simCardOp:"",uid:"",ver:e.version},rt=[],ot=0,it=ye.DEFAULT_PLATFORM,ct=Ue.screen||{},at=ct.width&&ct.width+"*"+ct.height,ut="0*0";at||(at=ut);var st={isEgret:!!Ue.egret,isLayabox:!!Ue.layabox,isCocos:!!Ue.cc&&!!Ue.cc.game},ft="",gt="",lt=Ue.navigator&&Ue.navigator.userAgent||"";if(!lt){var pt=["ios","android"];if(st.layabox){var dt=Ue.layabox.getDeviceInfo()||{};at=dt.resolution||ut,gt=dt.phonemodel,it=pt.indexOf(dt.os.toLowerCase()),ft=(dt.os+" "+dt.osversion).toLowerCase()}else if(st.cocos){var ht=Ue.cc.view.getViewPortRect()||{};at=ht.width+"*"+ht.height,it=pt.indexOf(Ue.cc.sys.os.toLowerCase())}-1===[0,1,2,3].indexOf(it)&&(it=ye.DEFAULT_PLATFORM)}var mt={resolution:at,brand:gt,osVersion:ft,platform:it};for(var bt in mt)nt[bt]=nt[bt]||mt[bt];var jt,vt="rd.gdatacube.net",Et="dcagent_create_time",Tt="EGRET",It="LAYA",Ot="COCOS",yt="UE",_t="dcagent_parent_id",St="dcagent_client_events",At="dcagent_client_errors",Ct="dcagent_client_id",Lt="dcagent_snapshot",Nt="dc_p_lo",Rt="/dc/hh5/sync",xt="0A",Dt="DE_EVENT_OSS",wt="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",Pt="accountId,accountType,age,gender,gameServer",Ut="roleId,roleRace,roleClass,roleLevel",Mt="DE_EVENT_COIN_ACTION",Vt="DE_EVENT_ITEM_ACTION",Gt="DE_EVENT_LEVELUP",Ft="DE_EVENT_GUANKA_ACTION",kt="DE_EVENT_TASK_ACTION",Ht="DE_EVENT_PV",Xt=!!Ue.localStorage||st.isEgret||st.isCocos||st.isLayabox;jt=st.isEgret?Ue.egret.localStorage:st.isCocos?Ue.cc.sys.localStorage:Xt?Ue.localStorage:{getItem:n,setItem:n,removeItem:n};var Bt,qt=jt,Kt=Ue.setTimeout,Yt=Ue.clearTimeout;st.isEgret&&(Kt=function(e,t){Ue.egret.setTimeout(e,Ue,t)},Yt=function(e){Ue.egret.clearTimeout(e)});var zt,Qt,Wt=0,Jt=x(),$t=Jt&&"cookie"in He,Zt=Pe.location||{},en="https:"===Zt.protocol?"https:":"http:",tn=!!Ue.XDomainRequest,nn=Ae.useXDR?function(){return new Ue.XDomainRequest}:function(){return new Ue.XMLHttpRequest},rn=st.isCocos?D:nn,on=function(){try{var e=rn();return e.timeout=1,!0}catch(t){return!1}}(),cn=Ae.useXDR?function(e,t){e.contentType=t}:function(e,t){e.setRequestHeader("Content-Type",t)},an=function(){return Ue.XMLHttpRequest||st.isCocos?w:st.isEgret?R:(Oe.log("XMLHttpRequest not found"),Oe.noop)}(),un=0,sn=Date.now()-ye.ASAP_TIMEOUT,fn=Ae.protocol+"//"+_e.HOST+_e.API_PATH,gn={login:X,getUid:S,onEvent:_},ln={onCoinGet:ce,onCoinUse:ie,onItemBuy:oe,onItemProduce:re,onItemUse:ne,onLevelUp:te,onMissionFinished:ee,onMissionUnfinished:Z,onPayment:$,onTaskFinished:J,onTaskUnfinished:W,setAccountType:Q,setAge:z,setGameServer:Y,setGender:K,setRoleInfo:B,createRole:q},pn=[Ce.shouldBeInited],dn=[Ce.shouldBeLoggedIn],hn=[Ne.setPollingDebounce];for(Qt in gn)e[Qt]=Oe.aspect(gn[Qt],pn,"onEvent"===Qt&&hn);for(Qt in ln)e[Qt]=Oe.aspect(ln[Qt],dn,"onPayment"!==Qt&&hn);var mn=Ue.DCAgentObject;if(mn){var bn=Ue[mn];if(Oe.isFunction(bn)){var jn=bn.cache;jn.length&&(jn.forEach(function(t){Oe.attempt(e[t[0]],e,Oe.slice(t,1))}),jn.length=0)}}var vn={get isNew(){var e=we.loginTime||we.initTime;return we.createTime===e},get initTime(){return we.initTime},get createTime(){return we.createTime},get loginTime(){return we.loginTime},get lastLogoutTime(){return parseInt(qt.getItem(_e.LOGOUT_TIME))},get reportCount(){return un},get reportFailedCount(){return Wt}},En={get:function(e){var t="(^|)\\s*"+e+"=([^\\s]*)",n=He.cookie.match(new RegExp(t));return n&&n.length>=3?decodeURIComponent(n[2]):null},set:function(e,t,n,r,o,i){var c;n&&(c=new Date,c.setTime(c.getTime()+864e5*n));var a=n?" expires="+c.toGMTString():"",u=" path="+(o||"/"),s=r?" domain="+r:"",f=i?" secure":"";He.cookie=e+"="+encodeURIComponent(t)+a+u+s+f},remove:function(e,t,n){En.set(e,"",-1,t,n)}},Tn=Ae.hasCookie?En:{get:Oe.noop,set:Oe.noop},In=Tn,On=Ue.navigator;he.prototype.isIE=function(){return"Microsoft Internet Explorer"===On.appName?!0:"Netscape"===On.appName&&/Trident/.test(On.userAgent)?!0:!1},he.prototype.getRegularPluginsString=function(){return this.map(On.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")};var yn=Ue.screen;he.prototype.get=function(){var e=[];if(e.push(On.userAgent),e.push(On.language),e.push(yn.colorDepth),this.screen_resolution){var t=this.getScreenResolution();"undefined"!=typeof t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!Ue.indexedDB),He.body?e.push(typeof He.body.addBehavior):e.push("undefined"),e.push(typeof Ue.openDatabase),e.push(On.cpuClass),e.push(On.platform),e.push(On.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},he.prototype.murmurhash3_32_gc=function(e,t){var n,r,o,i,c,a,u,s;for(n=3&e.length,r=e.length-n,o=t,c=3432918353,a=461845907,s=0;r>s;)u=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24,++s,u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=(65535&i)+27492+(((i>>>16)+58964&65535)<<16);switch(u=0,n){case 3:u^=(255&e.charCodeAt(s+2))<<16;break;case 2:u^=(255&e.charCodeAt(s+1))<<8;break;case 1:u^=255&e.charCodeAt(s),u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0},he.prototype.hasLocalStorage=function(){try{return!!Ue.localStorage}catch(e){return!0}},he.prototype.hasSessionStorage=function(){try{return!!Ue.sessionStorage}catch(e){return!0}},he.prototype.isCanvasSupported=function(){var e=He.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},he.prototype.getPluginsString=function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},he.prototype.getIEPluginsString=function(){if(Ue.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{return new Ue.ActiveXObject(e),e}catch(t){return null}}).join(";")}return""},he.prototype.getScreenResolution=function(){var e;return e=this.screen_orientation?yn.height>yn.width?[yn.height,yn.width]:[yn.width,yn.height]:[yn.height,yn.width]},he.prototype.getCanvasFingerprint=function(){var e=He.createElement("canvas"),t=e.getContext("2d"),n="http://www.dataeye.com/";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17),e.toDataURL()};var _n=he;e.init=Ee,e.player=vn,e.isReady=ae});