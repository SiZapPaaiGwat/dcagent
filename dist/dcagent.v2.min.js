!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.DCAgent={})}(this,function(e){"use strict";function t(){if(je)return je;if(De+=1,!(De>4)){var e={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"};for(var t in e){var n=e[t];if(n.indexOf(".")>-1){var r=n.split("."),o=Re[r[0]];if(o&&o[r[1]])return je=t,t}else if(Re[n])return je=t,t}}}function n(){}function r(e){return"function"==typeof e}function o(e){return e&&"[object Object]"===we.call(e)}function i(e){console.log("---- DCAgent log start ----\n"+e+"\n---- DCAgent log end   ----")}function c(e){var t,n,r;return t=Date.now(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r=n.replace(/[xy]/g,function(e){var n;return n=(t+16*Math.random())%16|0,t=Math.floor(t/16),"x"===e?n.toString(16):(7&n|8).toString(16)}),(e||"")+r.replace(/-/g,"").toUpperCase()}function a(e){var t,n;for(t in e)n=e[t],e[t]=n;var r=arguments.length>=2?[].slice.call(arguments,1):[];return r.forEach(function(r){var o;o=[];for(t in r)n=r[t],o.push(e[t]=n);return o}),e}function u(e,t,n){if(r(e))try{return e.apply(t,n)}catch(o){i("exec error for function:\n "+e.toString())}}function s(e){var t=".";try{return e.setItem(t,t),e.removeItem(t),!0}catch(n){return!1}}function f(e){for(var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n="",r=0;t>r;r+=1)n+=e;return n}function g(e,t,n){return e?e&&e.length>=n?e:e+f(t,Math.ceil(n-e.length)/t.length):e}function l(e,t,n){return function(){Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);var r,o;for(r=0;r<t.length;r+=1)if(o=t[r],u(o,this,arguments)===!1)return;var i=u(e,this,arguments);if(i===!1)return!1;for(r=0;r<n.length;r+=1)o=n[r],u(o,this,arguments);return i}}function p(e){if(!e)return"";var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return t?t[3]:""}function d(e,t,n){return[].slice.call(e,t,n)}function h(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return e>=1e21&&(e=9527e16),Re.parseInt(e,n)||t}function m(e){try{return e?JSON.stringify(e):null}catch(t){i("invalid json format")}return null}function b(e){try{return e?JSON.parse(e):null}catch(t){i("invalid json string")}return null}function j(){return{loginTime:Ne.loginTime,onlineTime:Ee.parseInt(Date.now()/1e3)-Ne.loginTime||1,extendMap:{from:Ne.from,engine:t()||"",app:Ne.app}}}function v(e,t){var n={headerInfo:ze,onlineInfo:j(),errorInfoList:Le.concat(),eventInfoList:Qe.concat()};return e&&(n.paymentInfo=e),t&&(n.userInfo=t),n}function E(){Qe.length=0,Le.length=0}function I(){Mt.setItem(Te.LOGOUT_TIME,Ee.parseInt(Date.now()/1e3)),(Le.length||Qe.length)&&Mt.setItem(Te.QUIT_SNAPSHOT,Ee.jsonStringify(v()))}function T(){return Ee.jsonParse(Mt.getItem(Te.QUIT_SNAPSHOT))}function O(e){We>=Ie.MAX_ERROR_COUNT||(Le.push(e),We+=1)}function y(e){Qe.push(e)}function _(e,t){if(!e)return Ee.log("Missing eventId"),!1;arguments.length>2&&(t=arguments[2]);var n={};if(Ee.isObject(t))for(var r in t)n[r.replace("%","_")]="number"==typeof t[r]?t[r]:encodeURIComponent(t[r]);return ve.addEvent({eventId:e,eventMap:n}),!0}function S(){return ze.uid||""}function A(e,t){var n=this;this.duration=t,this.status="running",this.timer=Vt(function(){return n.run()},this.duration),this.run=function(){Ft(n.timer),Ee.attempt(e),n.timer=Vt(function(){return n.run()},n.duration)},this.stop=function(){n.status="stopped",Ft(n.timer)},this.reset=function(e){n.stop(),e&&(n.duration=e),n.run()}}function C(e){Pt&&(Pt.stop(),Vt(function(){Pt.reset(e)},e))}function L(e,t){Pt=new A(e,t)}function N(){return Pt}function x(e){var t=Re.egret,n=new t.URLLoader,r=Date.now();n.addEventListener(t.Event.COMPLETE,function(t){var n=Date.now()-r,o=t.target,i="success"===o.data;Ee.attempt(i?e.success:e.error,o,[o,n,n>=e.timeout]),Ee.attempt(e.complete,o,[o,n])});var o=new t.URLRequest(e.url);o.method=e.method||t.URLRequestMethod.POST,o.data=Ee.jsonStringify(e.data),n.load(o)}function R(){return new Re.XMLHttpRequest}function D(){return Re.cc.loader.getXMLHttpRequest()}function w(e){var t=Xt();t.timeout=e.timeout,t.open(e.method||"POST",e.url,!0),t.setRequestHeader("Content-Type","text/plain; charset=UTF-8");var n=Date.now();t.onreadystatechange=function(){if(4===this.readyState){var t=this.status>=200&&this.status<300,r=Date.now()-n;Ee.attempt(t?e.success:e.error,this,[this,r]),Ee.attempt(e.complete,this,[this,r]),this.onreadystatechange=null,this.ontimeout=null}},t.ontimeout=function(){var t=Date.now()-n;Ee.attempt(e.error,this,[this,t,!0]),Ee.attempt(e.complete,this,[this,t]),this.onreadystatechange=null,this.ontimeout=null},t.send(Ee.jsonStringify(e.data))}function U(e,t){var n=Date.now();if(!t){if(Kt&&n-Kt<Ie.ASAP_TIMEOUT)return void Ee.log("Request dropped: unexpected behavior");Kt=n}qt+=1,Bt({url:e.url,data:e.data,success:function(t,n){Ee.attempt(e.success,t,[t,n])},error:function(t,n,r){Ht+=1,Ee.attempt(e.error,t,[t,n,r])},complete:function(t,n){if(Ee.attempt(e.complete,t,[t,n]),t.getAllResponseHeaders&&t.getResponseHeader){var r=t.getAllResponseHeaders(),o="X-Rate-Limit";if(-1!==r.indexOf(o)){var i=Ee.parseInt(t.getResponseHeader(o));i>1&&Oe.reset(1e3*i)}}}})}function P(e){if(!e)return!1;var t=e.onlineInfo.onlineTime;return 1>t||t>Ie.MAX_ONLINE_TIME?(Ee.log("Illegal online time"),!1):!0}function M(){if(Ue&&r(Ue.createElement)){var e=Ue.createElement("div");if(!e)return!1;if(r(e.querySelector)){e.innerHTML="<i></i>";var t=e.querySelector("i");return!!t&&"I"===t.tagName}if(r(e.getElementsByTagName)){var n=e.getElementsByTagName("i");return!!n&&1===n.length}}return!1}function V(e,t,n){if(e||!Ee.hiddenProperty||!Ue[Ee.hiddenProperty]){var r={url:Jt};if(qt&&qt%ze.oss===0&&ve.addEvent({eventId:Te.REQ_KEY,eventMap:{succ:qt-Ht,fail:Ht,total:qt}}),r.data=ve.collect(t,n),ye.isParamsValid(r.data)){ve.clear();var o=r.data.errorInfoList,i=r.data.eventInfoList;(i.length||o.length)&&(r.error=function(){o.forEach(function(e){ve.addError(e)}),i.forEach(function(e){ve.addEvent(e)})}),U(r,e)}}}function F(e){if(!e)return void Ee.log("Missing accountID");if(Ne.isLogin=!0,ze.accountId!==e){var t=Oe.get();t.stop(),V(!0);var n=Te.ACCOUNT_RELATED_SETTINGS+","+Te.ACCOUNT_ROLE_SETTINGS;n.split(",").forEach(function(e){return ze[e]=""}),ze.age=Ie.DEFAULT_AGE,ze.gender=Ie.DEFAULT_GENDER,ze.roleLevel=Ie.DEFAULT_ROLE_LEVEL,ze.accountId=e,ze.loginTime=parseInt(Date.now()/1e3),t.reset()}}function k(){console.log("debounce"),Ft(kt);var e=Oe.get();e.stop(),kt=Vt(function(){e.run()},Ie.ASAP_TIMEOUT)}function G(e,t,n,r){var o=arguments;Te.ACCOUNT_ROLE_SETTINGS.split(",").forEach(function(e,t){return ze[e]=o[t]||""}),ze.roleLevel=Ee.parseInt(r)||1}function H(e,t,n,r){G(e,t,n,r),_("DE_EVENT_CREATE_ROLE",{roleId:String(e),roleRace:String(t),roleClass:String(n)})}function X(e){ze.gender=2===e?2:1}function B(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];ze.gameServer=String(e)}function q(e){e=Ee.parseInt(e),ze.age=e>0&&128>e?e:0}function K(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];ze.accountType=String(e)}function Y(e,t){_(Te.EVT_TASK,{actionType:"taskUnfinish",taskId:e,elapsed:Ee.parseInt(t)})}function z(e,t){_(Te.EVT_TASK,{actionType:"taskFinish",taskId:e,elapsed:Ee.parseInt(t)})}function Q(e){e&&e.hasOwnProperty("amount")&&V(!0,{currencyAmount:parseFloat(e.amount,10)||0,currencyType:e.currencyType||"CNY",payType:String(e.payType||""),iapid:String(e.iapid||""),payTime:Ee.parseInt(Date.now()/1e3),extendMap:{orderId:String(e.orderId||"")}})}function W(e,t){_(Te.EVT_MISSION,{actionType:"guankaUnfinish",guankaId:e,duration:Ee.parseInt(t)})}function J(e,t){_(Te.EVT_MISSION,{actionType:"guankaFinish",guankaId:e,duration:Ee.parseInt(t)})}function $(e,t,n){t=Ee.parseInt(t),ze.roleLevel=t,_(Te.EVT_LEVEL,{startLevel:Ee.parseInt(e),endLevel:t,duration:Ee.parseInt(n)})}function Z(e,t,n,r){_(Te.EVT_ITEM,{actionType:"itemUse",itemId:e,itemNum:Ee.parseInt(t),reason:r,missonID:n})}function ee(e,t,n,r){_(Te.EVT_ITEM,{actionType:"itemGet",itemId:e,itemNum:Ee.parseInt(t),missonID:n,reason:r})}function te(e,t,n,r,o){_(Te.EVT_ITEM,{actionType:"itemBuy",itemId:e,itemNum:Ee.parseInt(t),coinType:n,coinNum:Ee.parseInt(r),missonID:o})}function ne(e,t,n,r){_(Te.EVT_COIN,{actionType:"coinUse",coinType:n,balanceNum:Ee.parseInt(t),coinNum:Ee.parseInt(e),reason:r})}function re(e,t,n,r){_(Te.EVT_COIN,{actionType:"coinGet",coinType:n,balanceNum:Ee.parseInt(t),coinNum:Ee.parseInt(e),reason:r})}function oe(){return Ne.inited}function ie(){for(var e=["pagehide","beforeunload","unload"],t=0;t<e.length;t+=1)if("on"+e[t]in Re)return e[t]}function ce(e){if(Re.addEventListener){var t=ie();t&&Re.addEventListener(t,e)}}function ae(){Re.addEventListener&&Re.addEventListener("error",function(e){Ee.attempt(function(){var t={},n=["colno","filename","lineno","message"];n.forEach(function(n){return t[n]=e[n]||"1"});var r=e.error||{};if(t.stack=encodeURIComponent(r.stack||r.stacktrace||""),t.type=r.name||"Error",t.timestamp=parseInt(e.timeStamp/1e3),Ee.isFunction(Ne.getErrorScene)){var o=Ee.attempt(Ne.getErrorScene,r,[e]);if(o){if(Ee.isObject(o)){var i="";for(var c in o)i+="	"+c+"="+o[c]+"\n";o=i}else o=String(o);t.stack+="\n\nError scene:\n"+encodeURIComponent(o)}}ve.addError(t)})},!1)}function ue(e){return _e.isStandardBrowser||Te.CLIENT_KEY===e?e:ze.appId+"."+e}function se(e,t){e=ue(e),Mt.setItem(e,t),fn.set(e,t,3650)}function fe(e){return e=ue(e),Mt.getItem(e)||fn.get(e)}function ge(){var e=Date.now().toString(36).toUpperCase(),t=Ce.engine;return t.egret?Te.EGRET_PREFIX+e:t.layabox?Te.LAYA_PREFIX+e:t.cocos?Te.COCOS_PREFIX+e:Te.UNKNOW_ENGINE+e}function le(e){var t,n;t=Array.prototype.forEach,n=Array.prototype.map,this.each=function(e,n,r){if(null!==e)if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===+e.length){for(var o=0,i=e.length;i>o;o++)if(n.call(r,e[o],o,e)==={})return}else for(var c in e)if(e.hasOwnProperty(c)&&n.call(r,e[c],c,e)==={})return},this.map=function(e,t,r){var o=[];return null==e?o:n&&e.map===n?e.map(t,r):(this.each(e,function(e,n,i){o[o.length]=t.call(r,e,n,i)}),o)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)}function pe(){var e;try{if(_e.isStandardBrowser)e=new pn({canvas:!0,screen_resolution:!0,ie_activex:!0}).get().toString();else if(Ce.engine.layabox){var t=Re.layabox.getDeviceInfo()||{};e=t.mac||t.idfa,e=e&&e.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(n){e=null}return e=Ee.padding(e,Te.PADDING_STRING,Ie.UID_MIN_LENGTH),e||Ee.uuid(ge())}function de(e){if(ze.uid){var t=Ee.padding(ze.uid,Te.PADDING_STRING,Ie.UID_MIN_LENGTH);e!==t&&(ze.uid=t,e=t,Mt.setItem(Te.CREATE_TIME,Ee.parseInt(Date.now()/1e3)))}var n=e||pe();return Ae.setItem(Te.CLIENT_KEY,n),n}function he(e){var t=Ae.getItem(Te.CLIENT_KEY),n=t?0:1,r=de(t);ze.uid=r,ze.accountId=r,e.errorReport&&ae(),Ne.loginTime=Ee.parseInt(Date.now()/1e3),Ne.initTime=Ne.loginTime;var o=Mt.getItem(Te.CREATE_TIME);o||(o=Ne.loginTime,Mt.setItem(Te.CREATE_TIME,o)),Ne.createTime=Ee.parseInt(o);var i=_e.isStandardBrowser?Qt.href:"!";ve.addEvent({eventId:Te.EVT_PV,eventMap:{page:encodeURI(i.split("?")[0])}});var c=n?{actTime:o,regTime:o}:null;V(!0,null,c),ce(ve.saveToStorage);var a=1e3*Math.max(Ie.MIN_ONLINE_INTERVAL,parseFloat(e.interval||Ie.MIN_ONLINE_INTERVAL));return Oe.set(V,a),Ne.inited=!0,!0}function me(e){return Ee.isLocalStorageSupported(Mt)?Ne.inited?void Ee.log("Initialization ignored"):e&&e.appId?(e.appId=e.appId.toUpperCase(),Ne.oss="number"==typeof e.oss?e.oss:0,Ne.getErrorScene=e.getErrorScene,Ne.app=e.appName||"",Ne.from=e.from||Ee.getHostName(Ue.referrer),Te.USER_INIT_BASE_SETTINGS.split(",").forEach(function(t){e.hasOwnProperty(t)&&(ze[t]=e[t])}),!0):void Ee.log("Missing appId"):void Ee.log(_e.hasStorage?"Storage quota error":"Storage not support")}function be(e){var t=me(e);return t?he(e):!1}var je,ve={get getOnlineInfo(){return j},get collect(){return v},get clear(){return E},get saveToStorage(){return I},get loadFromStorage(){return T},get addError(){return O},get addEvent(){return y}},Ee={get noop(){return n},get isFunction(){return r},get isObject(){return o},get log(){return i},get uuid(){return c},get extend(){return a},get attempt(){return u},get isLocalStorageSupported(){return s},get repeat(){return f},get padding(){return g},get aspect(){return l},get getHostName(){return p},get hiddenProperty(){return Pe},get slice(){return d},get parseInt(){return h},get jsonStringify(){return m},get jsonParse(){return b}},Ie={get REQUEST_TIME_OUT(){return Me},get MAX_ONLINE_TIME(){return Ve},get MIN_ONLINE_INTERVAL(){return Fe},get UID_MIN_LENGTH(){return ke},get ASAP_TIMEOUT(){return Ge},get MAX_ERROR_COUNT(){return He},get DEFAULT_AGE(){return Xe},get DEFAULT_GENDER(){return Be},get DEFAULT_ROLE_LEVEL(){return qe},get DEFAULT_NET_TYPE(){return Ke},get DEFAULT_PLATFORM(){return Ye}},Te={get HOST(){return gt},get CREATE_TIME(){return lt},get EGRET_PREFIX(){return pt},get LAYA_PREFIX(){return dt},get COCOS_PREFIX(){return ht},get UNKNOW_ENGINE(){return mt},get PARENT_KEY(){return bt},get EVENTS_KEY(){return jt},get ERRORS_KEY(){return vt},get CLIENT_KEY(){return Et},get QUIT_SNAPSHOT(){return It},get LOGOUT_TIME(){return Tt},get API_PATH(){return Ot},get PADDING_STRING(){return yt},get REQ_KEY(){return _t},get USER_INIT_BASE_SETTINGS(){return St},get ACCOUNT_RELATED_SETTINGS(){return At},get ACCOUNT_ROLE_SETTINGS(){return Ct},get EVT_COIN(){return Lt},get EVT_ITEM(){return Nt},get EVT_LEVEL(){return xt},get EVT_MISSION(){return Rt},get EVT_TASK(){return Dt},get EVT_PV(){return wt}},Oe={get reset(){return C},get set(){return L},get get(){return N}},ye={get isParamsValid(){return P}},_e={get hasStorage(){return Ut},get isStandardBrowser(){return Yt},get hasCookie(){return zt},get protocol(){return Wt},get device(){return ut}},Se={get debounce(){return k}},Ae={get setItem(){return se},get getItem(){return fe}},Ce={get engine(){return tt},get"default"(){return t}},Le=[],Ne={inited:!1},xe=(1,eval)("this"),Re=xe||{},De=0,we=Object.prototype.toString,Ue=xe.document||{},Pe="hidden"in Ue?"hidden":"webkitHidden"in Ue?"webkitHidden":"mozHidden"in Ue?"mozHidden":"msHidden"in Ue?"msHidden":null;e.version=24;var Me=3e4,Ve=172800,Fe=40,ke=32,Ge=5e3,He=100,Xe=0,Be=0,qe=0,Ke=3,Ye=0,ze={accountId:"",accountType:"",age:Ie.DEFAULT_AGE,appId:"",appVersion:"",brand:"",channel:"",customDeviceId:"",gameServer:"",gender:Ie.DEFAULT_GENDER,idfa:"",imei:"",lonLat:"",mac:"",netType:Ie.DEFAULT_NET_TYPE,operator:"",osVersion:"",platform:Ie.DEFAULT_PLATFORM,resolution:"",roleClass:"",roleId:"",roleLevel:Ie.DEFAULT_ROLE_LEVEL,roleRace:"",simCardOp:"",uid:"",ver:e.version},Qe=[],We=0,Je=Ie.DEFAULT_PLATFORM,$e=Re.screen||{},Ze=$e.width&&$e.width+"*"+$e.height,et="0*0";Ze||(Ze=et);var tt={isEgret:!!Re.egret,isLayabox:!!Re.layabox,isCocos:!!Re.cc&&!!Re.cc.game},nt="",rt="",ot=Re.navigator&&Re.navigator.userAgent||"";if(!ot){var it=["ios","android"];if(tt.layabox){var ct=Re.layabox.getDeviceInfo()||{};Ze=ct.resolution||et,rt=ct.phonemodel,Je=it.indexOf(ct.os.toLowerCase()),nt=(ct.os+" "+ct.osversion).toLowerCase()}else if(tt.cocos){var at=Re.cc.view.getViewPortRect()||{};Ze=at.width+"*"+at.height,Je=it.indexOf(Re.cc.sys.os.toLowerCase())}-1===[0,1,2,3].indexOf(Je)&&(Je=Ie.DEFAULT_PLATFORM)}var ut={resolution:Ze,brand:rt,osVersion:nt,platform:Je};for(var st in ut)ze[st]=ze[st]||ut[st];var ft,gt="rd.gdatacube.net",lt="dcagent_create_time",pt="EGRET",dt="LAYA",ht="COCOS",mt="UE",bt="dcagent_parent_id",jt="dcagent_client_events",vt="dcagent_client_errors",Et="dcagent_client_id",It="dcagent_snapshot",Tt="dc_p_lo",Ot="/dc/hh5/sync",yt="0A",_t="DE_EVENT_OSS",St="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",At="accountId,accountType,age,gender,gameServer",Ct="roleId,roleRace,roleClass,roleLevel",Lt="DE_EVENT_COIN_ACTION",Nt="DE_EVENT_ITEM_ACTION",xt="DE_EVENT_LEVELUP",Rt="DE_EVENT_GUANKA_ACTION",Dt="DE_EVENT_TASK_ACTION",wt="DE_EVENT_PV",Ut=!!Re.localStorage||tt.isEgret||tt.isCocos||tt.isLayabox;ft=tt.isEgret?Re.egret.localStorage:tt.isCocos?Re.cc.sys.localStorage:Ut?Re.localStorage:{getItem:n,setItem:n,removeItem:n};var Pt,Mt=ft,Vt=Re.setTimeout,Ft=Re.clearTimeout;tt.isEgret&&(Vt=function(e,t){Re.egret.setTimeout(e,Re,t)},Ft=function(e){Re.egret.clearTimeout(e)});var kt,Gt,Ht=0,Xt=tt.isCocos?D:R,Bt=function(){return Re.XMLHttpRequest||tt.isCocos?w:tt.isEgret?x:(Ee.log("XMLHttpRequest not found"),Ee.noop)}(),qt=0,Kt=0,Yt=M(),zt=Yt&&"cookie"in Ue,Qt=xe.location||{},Wt="https:"===Qt.protocol?"https:":"http:",Jt=_e.protocol+"//"+Te.HOST+Te.API_PATH,$t={login:F,getUid:S,onEvent:_},Zt={onCoinGet:re,onCoinUse:ne,onItemBuy:te,onItemProduce:ee,onItemUse:Z,onLevelUp:$,onMissionFinished:J,onMissionUnfinished:W,onPayment:Q,onTaskFinished:z,onTaskUnfinished:Y,setAccountType:K,setAge:q,setGameServer:B,setGender:X,setRoleInfo:G,createRole:H},en=[function(){return Ne.inited}],tn=[function(){return Ne.isLogin}],nn=[Se.debounce];for(Gt in $t)e[Gt]=Ee.aspect($t[Gt],en,"onEvent"===Gt&&nn);for(Gt in Zt)e[Gt]=Ee.aspect(Zt[Gt],tn,"onPayment"!==Gt&&nn);var rn=Re.DCAgentObject;if(rn){var on=Re[rn];if(Ee.isFunction(on)){var cn=on.cache;cn.length&&(cn.forEach(function(t){Ee.attempt(e[t[0]],e,Ee.slice(t,1))}),cn.length=0)}}var an={get isNew(){return Ne.createTime===Ne.loginTime},get initTime(){return Ne.initTime},get createTime(){return Ne.createTime},get loginTime(){return Ne.loginTime},get lastLogoutTime(){return parseInt(Mt.getItem(Te.LOGOUT_TIME))},get getReportCount(){return qt},get getReportFailedCount(){return Ht}},un={get:function(e){var t="(^|)\\s*"+e+"=([^\\s]*)",n=Ue.cookie.match(new RegExp(t));return n&&n.length>=3?decodeURIComponent(n[2]):null},set:function(e,t,n,r,o,i){var c;n&&(c=new Date,c.setTime(c.getTime()+864e5*n));var a=n?" expires="+c.toGMTString():"",u=" path="+(o||"/"),s=r?" domain="+r:"",f=i?" secure":"";Ue.cookie=e+"="+encodeURIComponent(t)+a+u+s+f},remove:function(e,t,n){un.set(e,"",-1,t,n)}},sn=_e.hasCookie?un:{get:Ee.noop,set:Ee.noop},fn=sn,gn=Re.navigator;le.prototype.isIE=function(){return"Microsoft Internet Explorer"===gn.appName?!0:"Netscape"===gn.appName&&/Trident/.test(gn.userAgent)?!0:!1},le.prototype.getRegularPluginsString=function(){return this.map(gn.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")};var ln=Re.screen;le.prototype.get=function(){var e=[];if(e.push(gn.userAgent),e.push(gn.language),e.push(ln.colorDepth),this.screen_resolution){var t=this.getScreenResolution();"undefined"!=typeof t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!Re.indexedDB),Ue.body?e.push(typeof Ue.body.addBehavior):e.push("undefined"),e.push(typeof Re.openDatabase),e.push(gn.cpuClass),e.push(gn.platform),e.push(gn.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},le.prototype.murmurhash3_32_gc=function(e,t){var n,r,o,i,c,a,u,s;for(n=3&e.length,r=e.length-n,o=t,c=3432918353,a=461845907,s=0;r>s;)u=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24,++s,u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=(65535&i)+27492+(((i>>>16)+58964&65535)<<16);switch(u=0,n){case 3:u^=(255&e.charCodeAt(s+2))<<16;break;case 2:u^=(255&e.charCodeAt(s+1))<<8;break;case 1:u^=255&e.charCodeAt(s),u=(65535&u)*c+(((u>>>16)*c&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,o^=u}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0},le.prototype.hasLocalStorage=function(){try{return!!Re.localStorage}catch(e){return!0}},le.prototype.hasSessionStorage=function(){try{return!!Re.sessionStorage}catch(e){return!0}},le.prototype.isCanvasSupported=function(){var e=Ue.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},le.prototype.getPluginsString=function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},le.prototype.getIEPluginsString=function(){if(Re.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{return new Re.ActiveXObject(e),e}catch(t){return null}}).join(";")}return""},le.prototype.getScreenResolution=function(){var e;return e=this.screen_orientation?ln.height>ln.width?[ln.height,ln.width]:[ln.width,ln.height]:[ln.height,ln.width]},le.prototype.getCanvasFingerprint=function(){var e=Ue.createElement("canvas"),t=e.getContext("2d"),n="http://www.dataeye.com/";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17),e.toDataURL()};var pn=le;e.init=be,e.player=an,e.isReady=oe});