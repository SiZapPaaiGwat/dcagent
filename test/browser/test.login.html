<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>DCAgent Test Suite</title>
  <link rel="shortcut icon" type="image/png" href="../libs/jasmine_favicon.png">
  <link rel="stylesheet" href="../libs/jasmine.css">

  <script src="../libs/jasmine.js"></script>
  <script src="../libs/jasmine-html.js"></script>
  <script src="../libs/boot.js"></script>
  <script>
    var DCAGENT_DEBUG_OPEN = true
  </script>
  <script src="../../dist/dcagent.v2.src.js"></script>
</head>
<body>
<script>
  /*globals describe, it, expect, DCAgent*/
  describe('DCAgent.login', function() {
    it('should invoke after init', function() {
      var login = function() {
        DCAgent.login('simon')
      }
      expect(login).toThrow()
      expect(DCAgent.player.loginTime).toBeUndefined()

      // 减一秒，防止时间精度不够
      var start = Math.floor(Date.now() / 1000) - 1
      login = function() {
        DCAgent.init({appId: 'appid'})
        DCAgent.login('simon')
      }
      var end = Math.ceil(Date.now() / 1000)
      expect(login).not.toThrow()
      expect(DCAgent.player.loginTime).toBeLessThan(end)
      expect(DCAgent.player.loginTime).toBeGreaterThan(start)
    })
  })
</script>
</body>
</html>
